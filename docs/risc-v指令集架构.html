<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>RISC-V指令集架构 - Laumy的技术栈</title>
    <link rel="stylesheet" href="../note_page/assets/style.css">
    <!-- MathJax支持LaTeX数学公式 -->
    <script>
      window.MathJax = {
        tex: {
          inlineMath: [['$', '$'], ['\\(', '\\)']],
          displayMath: [['$$', '$$'], ['\\[', '\\]']],
          processEscapes: true,
          processEnvironments: true
        },
        options: {
          ignoreHtmlClass: 'tex2jax_ignore',
          processHtmlClass: 'tex2jax_process'
        }
      };
    </script>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
  </head>
  <body>
    <header class="site-header">
      <div class="container">
        <a class="logo" href="../note_page/">Laumy的技术栈</a>
        <div class="search">
          <input id="search-input" type="text" placeholder="输入关键词回车搜索">
        </div>
        <div class="theme-toggle" title="切换主题" id="theme-toggle">☾</div>
        <nav class="top-nav">
          <div class="nav-item"><a href="../note_page/">首页</a></div>
        </nav>
      </div>
    </header>

    <main class="container layout">
      <aside class="left-nav">
        
        <div class="card">
          <div class="card-title">文章目录</div>
          <nav id="toc"><ul><li><a href="#_1">简介</a><ul></ul></li><li><a href="#_2">指令集</a><ul><li><a href="#_3">整形指令集</a></li><li><a href="#_4">乘除指令集</a></li><li><a href="#_5">原子扩展指令集</a></li><li><a href="#_6">浮点扩展指令集</a></li><li><a href="#_7">伪指令</a></li></ul></li><li><a href="#_8">寄存器</a><ul><li><a href="#_9">通用寄存器</a></li><li><a href="#_10">特权寄存器</a></li><li><a href="#mepc">mepc寄存器</a></li></ul></li><li><a href="#_11">异常处理流程</a><ul></ul></li></ul></nav>
        </div>
        
      </aside>

      <section class="content">
        
<article class="card post">
  <h1>RISC-V指令集架构</h1>
  <div class="meta">2024-04-27 · risc-v</div>
  <div class="post-content"><h2 id="_1">简介</h2>
<p>RISC-V是一个通用的指令集架构（ISA），ISA是底层硬件电路面向上层软件程序提供的一层接口规范，ISA定义了：</p>
<ul>
<li>基本数据类型，BYTE/HALFWORD/WORD</li>
<li>寄存器</li>
<li>指令</li>
<li>寻址模式</li>
<li>异常或中断处理方式</li>
</ul>
<p>之所以需要ISA，是为上层软件提供一层抽象，制定规则和约束，让编程者不用关心具体的电路结构，目前的指令集架构有两种类别: - CISC复杂指令集（Complex Instruction Set Computing），这类指令针对特定功能的实现需要新增实现特定的指令，导致指令数目比较多，但生成的程序长度相对较短； - RISC精简指令集（Reduced Instruction Set Computing）,只定义常用指令，对复杂的功能采用常用指令组合实现，这导致指令数目比较精简，但生成的程序长度相对较长。</p>
<p>ISA的宽度指定是CPU中通用寄存器的宽度，决定了寻址的范围大小以及数据运算的能力。当前ISA有以下</p>
<ul>
<li>X86</li>
<li>SPARC</li>
<li>POWER</li>
<li>ARM</li>
<li>MIPS</li>
<li>RISC-V</li>
</ul>
<p>RISC-V ISA命名格式为RV[###][abc...xyz]，如RV64IMA;</p>
<ul>
<li>RV：标识RISC-V体系结构前缀</li>
<li>[###]：{32,64,128}用于标识处理器的子宽，即处理器寄存器的宽度，单位为bit</li>
<li>[abc...xyz]：标识处理器支持的指令集模块集合，见下描述</li>
</ul>
<p>RISCV-ISA指令集按照模块来划分，=1个基本整数指令集+多个可选拓展指令集</p>
<ul>
<li>整数指令集（interger）：强制要求实现的基础指令集，RV32I,RV64I</li>
<li>扩展指令集：M为整数乘与除法指令集，A存储器原子指令集，F单精度浮点指令集，D双精度浮点指令，兼容F，C压缩指令集。而GC代表IMAFDC的组合。</li>
</ul>
<p>根据以上RV32IMAC表示32位实现，支持interger，multiply，atomic，compressed；RV64GC，就是表示支持RV64位IMAFDC。</p>
<h2 id="_2">指令集</h2>
<p>RISC-V的指令集可分为6中，每种的编码格式如下：</p>
<p><a href="https://www.laumy.tech/wp-content/uploads/2024/04/wp_editor_md_09497aa55c661c176eb5beab5d2dd0c8.jpg"><img alt="" src="assets/doc/02-risc-v/risc-v指令集架构/images/wp_editor_md_09497aa55c661c176eb5beab5d2dd0c8.jpg"/></a></p>
<h3 id="_3">整形指令集</h3>
<p><a href="https://www.laumy.tech/wp-content/uploads/2024/04/wp_editor_md_73663b05545c28d5613477825e0fe95c.jpg"><img alt="" src="assets/doc/02-risc-v/risc-v指令集架构/images/wp_editor_md_73663b05545c28d5613477825e0fe95c.jpg"/></a></p>
<h3 id="_4">乘除指令集</h3>
<p><a href="https://www.laumy.tech/wp-content/uploads/2024/04/wp_editor_md_eaad957d98058795794b5858e6b26267.jpg"><img alt="" src="assets/doc/02-risc-v/risc-v指令集架构/images/wp_editor_md_eaad957d98058795794b5858e6b26267.jpg"/></a></p>
<h3 id="_5">原子扩展指令集</h3>
<p><a href="https://www.laumy.tech/wp-content/uploads/2024/04/wp_editor_md_f610791797524f021b91b439eae0e0a9.jpg"><img alt="" src="assets/doc/02-risc-v/risc-v指令集架构/images/wp_editor_md_f610791797524f021b91b439eae0e0a9.jpg"/></a></p>
<h3 id="_6">浮点扩展指令集</h3>
<p><a href="https://www.laumy.tech/wp-content/uploads/2024/04/wp_editor_md_5631b217c44ba0e5184a566c9e7b1898.jpg"><img alt="" src="assets/doc/02-risc-v/risc-v指令集架构/images/wp_editor_md_5631b217c44ba0e5184a566c9e7b1898.jpg"/></a></p>
<h3 id="_7">伪指令</h3>
<p>为了方便编程，对指令进一步封装，形成伪指令</p>
<p><a href="https://www.laumy.tech/wp-content/uploads/2024/04/wp_editor_md_f4f2d8aa275ea08d3b5a151de477767e.jpg"><img alt="" src="assets/doc/02-risc-v/risc-v指令集架构/images/wp_editor_md_f4f2d8aa275ea08d3b5a151de477767e.jpg"/></a></p>
<h2 id="_8">寄存器</h2>
<h3 id="_9">通用寄存器</h3>
<p><a href="https://www.laumy.tech/wp-content/uploads/2024/04/wp_editor_md_7f01262e0eb4069dddb2af53508e714b.jpg"><img alt="" src="assets/doc/02-risc-v/risc-v指令集架构/images/wp_editor_md_7f01262e0eb4069dddb2af53508e714b.jpg"/></a></p>
<h3 id="_10">特权寄存器</h3>
<p>RISC-V指令运行，根据访问权限，分为M/S/U模式，每个模式下有自己对应的寄存器，这里重点列出M模式相关的寄存器。</p>
<h4 id="mstatus">mstatus寄存器</h4>
<p><a href="https://www.laumy.tech/wp-content/uploads/2024/04/wp_editor_md_79d43c8bffcbde2b30d3040aa855d44b.jpg"><img alt="" src="assets/doc/02-risc-v/risc-v指令集架构/images/wp_editor_md_79d43c8bffcbde2b30d3040aa855d44b.jpg"/></a></p>
<h4 id="mie">mie寄存器</h4>
<p><a href="https://www.laumy.tech/wp-content/uploads/2024/04/wp_editor_md_087b9e60788d7e4b8068b7d65606c5b5.jpg"><img alt="" src="assets/doc/02-risc-v/risc-v指令集架构/images/wp_editor_md_087b9e60788d7e4b8068b7d65606c5b5.jpg"/></a></p>
<h4 id="mip">mip寄存器</h4>
<p><a href="https://www.laumy.tech/wp-content/uploads/2024/04/wp_editor_md_3df50c63e292f90596fea5b378a460ed.jpg"><img alt="" src="assets/doc/02-risc-v/risc-v指令集架构/images/wp_editor_md_3df50c63e292f90596fea5b378a460ed.jpg"/></a></p>
<h4 id="mtvec">mtvec寄存器</h4>
<p><a href="https://www.laumy.tech/wp-content/uploads/2024/04/wp_editor_md_5ab5033fe5ecc5b5ebb4f2fec309318e.jpg"><img alt="" src="assets/doc/02-risc-v/risc-v指令集架构/images/wp_editor_md_5ab5033fe5ecc5b5ebb4f2fec309318e.jpg"/></a></p>
<h3 id="mepc">mepc寄存器</h3>
<p><a href="https://www.laumy.tech/wp-content/uploads/2024/04/wp_editor_md_fa472fc5a440dc329446958520de83e6.jpg"><img alt="" src="assets/doc/02-risc-v/risc-v指令集架构/images/wp_editor_md_fa472fc5a440dc329446958520de83e6.jpg"/></a></p>
<h4 id="mscratch">mscratch寄存器</h4>
<p><a href="https://www.laumy.tech/wp-content/uploads/2024/04/wp_editor_md_9f0e5d44172cf6005adad6277e67907b.jpg"><img alt="" src="assets/doc/02-risc-v/risc-v指令集架构/images/wp_editor_md_9f0e5d44172cf6005adad6277e67907b.jpg"/></a></p>
<h4 id="mcause">mcause寄存器</h4>
<p><a href="https://www.laumy.tech/wp-content/uploads/2024/04/wp_editor_md_9321d039df470545c49a94f42828cf46.jpg"><img alt="" src="assets/doc/02-risc-v/risc-v指令集架构/images/wp_editor_md_9321d039df470545c49a94f42828cf46.jpg"/></a></p>
<p>对于mcause exception code如下：</p>
<p><a href="https://www.laumy.tech/wp-content/uploads/2024/04/wp_editor_md_a2ecc618b879e25a0dbd320647ace748.jpg"><img alt="" src="assets/doc/02-risc-v/risc-v指令集架构/images/wp_editor_md_a2ecc618b879e25a0dbd320647ace748.jpg"/></a></p>
<h2 id="_11">异常处理流程</h2>
<p><a href="https://www.laumy.tech/wp-content/uploads/2024/04/wp_editor_md_7c027a9c2fa6f88fecb400c687ac5f09.jpg"><img alt="" src="assets/doc/02-risc-v/risc-v指令集架构/images/wp_editor_md_7c027a9c2fa6f88fecb400c687ac5f09.jpg"/></a></p></div>
  <div class="post-nav">
    <a class="prev" href="../note_page/平头哥risc-v-gdb-vscode调试.html">← 平头哥RISC-V+gdb+vscode调试</a>
    <a class="next" href="../note_page/qemu-system-riscv64-virt平台rom代码启动分析.html">qemu-system-riscv64 virt平台ROM代码启动分析 →</a>
  </div>
</article>

      </section>

      <aside class="right-panel">
        
      </aside>
    </main>

    <footer class="site-footer">
      <div class="container">Copyright ©2022-2025 laumy 版权所有</div>
    </footer>

    <script src="../note_page/assets/site.js"></script>
  </body>
  </html>

