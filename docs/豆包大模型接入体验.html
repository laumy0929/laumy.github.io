<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>豆包大模型接入体验 - Laumy的技术栈</title>
    <link rel="stylesheet" href="../../assets/style.css">
    <!-- MathJax支持LaTeX数学公式 -->
    <script>
      window.MathJax = {
        tex: {
          inlineMath: [['$', '$'], ['\\(', '\\)']],
          displayMath: [['$$', '$$'], ['\\[', '\\]']],
          processEscapes: true,
          processEnvironments: true
        },
        options: {
          ignoreHtmlClass: 'tex2jax_ignore',
          processHtmlClass: 'tex2jax_process'
        }
      };
    </script>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
  </head>
  <body>
    <header class="site-header">
      <div class="container">
        <a class="logo" href="../../">Laumy的技术栈</a>
        <div class="search">
          <input id="search-input" type="text" placeholder="输入关键词回车搜索">
        </div>
        <div class="theme-toggle" title="切换主题" id="theme-toggle">☾</div>
        <nav class="top-nav">
          <div class="nav-item"><a href="../../">首页</a></div>
        </nav>
      </div>
    </header>

    <main class="container layout">
      <aside class="left-nav">
        
        <div class="card">
          <div class="card-title">文章目录</div>
          <nav id="toc"><ul><li><a href="#api-key">API key获取</a><ul></ul></li><li><a href="#_2">创建推理接入点</a><ul></ul></li><li><a href="#python">安装python环境</a><ul></ul></li><li><a href="#_3">测试</a><ul><li><a href="#_4">单张图片测试</a></li></ul></li></ul></nav>
        </div>
        
      </aside>

      <section class="content">
        
<article class="card post">
  <h1>豆包大模型接入体验</h1>
  <div class="meta">2025-01-01 · ai</div>
  <div class="post-content"><h1 id="_1">前置条件</h1>
<p>需要先创建获得API key和创建推理接入点。</p>
<h2 id="api-key">API key获取</h2>
<p>https://www.volcengine.com/docs/82379/1361424#f79da451</p>
<p><a href="https://www.laumy.tech/wp-content/uploads/2025/01/wp_editor_md_43e096b28cfa11f56ab84efb2da7d7e9.jpg"><img alt="" src="assets/doc/04-ai/ai应用/豆包大模型接入体验/images/wp_editor_md_43e096b28cfa11f56ab84efb2da7d7e9.jpg"/></a></p>
<h2 id="_2">创建推理接入点</h2>
<p>https://www.volcengine.com/docs/82379/1099522</p>
<p><a href="https://www.laumy.tech/wp-content/uploads/2025/01/wp_editor_md_be229f55fcf1a9ac373ff2256d5b1d36.jpg"><img alt="" src="assets/doc/04-ai/ai应用/豆包大模型接入体验/images/wp_editor_md_be229f55fcf1a9ac373ff2256d5b1d36.jpg"/></a></p>
<h2 id="python">安装python环境</h2>
<p>python版本需要安装到Python 2.7或以上版本。执行python --version可以检查当前Python的版本信息。我这里的版本已经到3.8.10</p>
<div class="codehilite"><pre><span></span><code><span class="n">python3</span><span class="w"> </span><span class="o">--</span><span class="n">version</span>
<span class="n">Python</span><span class="w"> </span><span class="mf">3.8.10</span>
</code></pre></div>
<p>接着安装豆包sdk</p>
<div class="codehilite"><pre><span></span><code><span class="n">pip</span><span class="w"> </span><span class="n">install</span><span class="w"> </span><span class="n">volcengine</span><span class="o">-</span><span class="n">python</span><span class="o">-</span><span class="n">sdk</span>
<span class="n">Collecting</span><span class="w"> </span><span class="n">volcengine</span><span class="o">-</span><span class="n">python</span><span class="o">-</span><span class="n">sdk</span>
<span class="w">  </span><span class="n">Downloading</span><span class="w"> </span><span class="n">volcengine</span><span class="o">-</span><span class="n">python</span><span class="o">-</span><span class="n">sdk</span><span class="mf">-1.0.118</span><span class="p">.</span><span class="n">tar</span><span class="p">.</span><span class="n">gz</span><span class="w"> </span><span class="p">(</span><span class="mf">3.1</span><span class="w"> </span><span class="n">MB</span><span class="p">)</span>
<span class="w">     </span><span class="o">|</span><span class="err">████████████████████████████████</span><span class="o">|</span><span class="w"> </span><span class="mf">3.1</span><span class="w"> </span><span class="n">MB</span><span class="w"> </span><span class="mf">9.7</span><span class="w"> </span><span class="n">kB</span><span class="o">/</span><span class="n">s</span><span class="w"> </span>
<span class="n">Requirement</span><span class="w"> </span><span class="n">already</span><span class="w"> </span><span class="n">satisfied</span><span class="o">:</span><span class="w"> </span><span class="n">certifi</span><span class="o">&gt;=</span><span class="mf">2017.4.17</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">/</span><span class="n">dist</span><span class="o">-</span><span class="n">packages</span><span class="w"> </span><span class="p">(</span><span class="n">from</span><span class="w"> </span><span class="n">volcengine</span><span class="o">-</span><span class="n">python</span><span class="o">-</span><span class="n">sdk</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="mf">2019.11.28</span><span class="p">)</span>
<span class="n">Requirement</span><span class="w"> </span><span class="n">already</span><span class="w"> </span><span class="n">satisfied</span><span class="o">:</span><span class="w"> </span><span class="n">python</span><span class="o">-</span><span class="n">dateutil</span><span class="o">&gt;=</span><span class="mf">2.1</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">/</span><span class="n">dist</span><span class="o">-</span><span class="n">packages</span><span class="w"> </span><span class="p">(</span><span class="n">from</span><span class="w"> </span><span class="n">volcengine</span><span class="o">-</span><span class="n">python</span><span class="o">-</span><span class="n">sdk</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="mf">2.7.3</span><span class="p">)</span>
<span class="n">Requirement</span><span class="w"> </span><span class="n">already</span><span class="w"> </span><span class="n">satisfied</span><span class="o">:</span><span class="w"> </span><span class="n">six</span><span class="o">&gt;=</span><span class="mf">1.10</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">/</span><span class="n">dist</span><span class="o">-</span><span class="n">packages</span><span class="w"> </span><span class="p">(</span><span class="n">from</span><span class="w"> </span><span class="n">volcengine</span><span class="o">-</span><span class="n">python</span><span class="o">-</span><span class="n">sdk</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="mf">1.14.0</span><span class="p">)</span>
<span class="n">Requirement</span><span class="w"> </span><span class="n">already</span><span class="w"> </span><span class="n">satisfied</span><span class="o">:</span><span class="w"> </span><span class="n">urllib3</span><span class="o">&gt;=</span><span class="mf">1.23</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">/</span><span class="n">dist</span><span class="o">-</span><span class="n">packages</span><span class="w"> </span><span class="p">(</span><span class="n">from</span><span class="w"> </span><span class="n">volcengine</span><span class="o">-</span><span class="n">python</span><span class="o">-</span><span class="n">sdk</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="mf">1.25.8</span><span class="p">)</span>
<span class="n">Building</span><span class="w"> </span><span class="n">wheels</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">collected</span><span class="w"> </span><span class="n">packages</span><span class="o">:</span><span class="w"> </span><span class="n">volcengine</span><span class="o">-</span><span class="n">python</span><span class="o">-</span><span class="n">sdk</span>
<span class="w">  </span><span class="n">Building</span><span class="w"> </span><span class="n">wheel</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">volcengine</span><span class="o">-</span><span class="n">python</span><span class="o">-</span><span class="n">sdk</span><span class="w"> </span><span class="p">(</span><span class="n">setup</span><span class="p">.</span><span class="n">py</span><span class="p">)</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="n">done</span>
<span class="w">  </span><span class="n">Created</span><span class="w"> </span><span class="n">wheel</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">volcengine</span><span class="o">-</span><span class="n">python</span><span class="o">-</span><span class="n">sdk</span><span class="o">:</span><span class="w"> </span><span class="n">filename</span><span class="o">=</span><span class="n">volcengine_python_sdk</span><span class="mf">-1.0.118</span><span class="o">-</span><span class="n">py3</span><span class="o">-</span><span class="n">none</span><span class="o">-</span><span class="n">any</span><span class="p">.</span><span class="n">whl</span><span class="w"> </span><span class="n">size</span><span class="o">=</span><span class="mi">10397043</span><span class="w"> </span><span class="n">sha256</span><span class="o">=</span><span class="n">c4546246eb0ef4e1c68e8047c6f2773d601821bd1acb7bc3a6162919f161423b</span>
<span class="w">  </span><span class="n">Stored</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="n">directory</span><span class="o">:</span><span class="w"> </span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">apple</span><span class="o">/</span><span class="p">.</span><span class="n">cache</span><span class="o">/</span><span class="n">pip</span><span class="o">/</span><span class="n">wheels</span><span class="o">/</span><span class="n">d2</span><span class="o">/</span><span class="n">dc</span><span class="o">/</span><span class="mi">23</span><span class="o">/</span><span class="mf">70f</span><span class="n">a1060e1a527a290fc87a35469401b7588cdb51a2b75797d</span>
<span class="n">Successfully</span><span class="w"> </span><span class="n">built</span><span class="w"> </span><span class="n">volcengine</span><span class="o">-</span><span class="n">python</span><span class="o">-</span><span class="n">sdk</span>
<span class="n">Installing</span><span class="w"> </span><span class="n">collected</span><span class="w"> </span><span class="n">packages</span><span class="o">:</span><span class="w"> </span><span class="n">volcengine</span><span class="o">-</span><span class="n">python</span><span class="o">-</span><span class="n">sdk</span>
<span class="n">Successfully</span><span class="w"> </span><span class="n">installed</span><span class="w"> </span><span class="n">volcengine</span><span class="o">-</span><span class="n">python</span><span class="o">-</span><span class="n">sdk</span><span class="mf">-1.0.118</span>
</code></pre></div>
<p>需要更新</p>
<div class="codehilite"><pre><span></span><code><span class="n">pip</span><span class="w"> </span><span class="n">install</span><span class="w"> </span><span class="o">--</span><span class="n">upgrade</span><span class="w"> </span><span class="err">'</span><span class="n">volcengine</span><span class="o">-</span><span class="n">python</span><span class="o">-</span><span class="n">sdk</span><span class="p">[</span><span class="n">ark</span><span class="p">]</span><span class="err">'</span>
<span class="n">Requirement</span><span class="w"> </span><span class="n">already</span><span class="w"> </span><span class="n">up</span><span class="o">-</span><span class="n">to</span><span class="o">-</span><span class="n">date</span><span class="o">:</span><span class="w"> </span><span class="n">volcengine</span><span class="o">-</span><span class="n">python</span><span class="o">-</span><span class="n">sdk</span><span class="p">[</span><span class="n">ark</span><span class="p">]</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">apple</span><span class="o">/</span><span class="p">.</span><span class="n">local</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.8</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="w"> </span><span class="p">(</span><span class="mf">1.0.118</span><span class="p">)</span>

<span class="n">Requirement</span><span class="w"> </span><span class="n">already</span><span class="w"> </span><span class="n">satisfied</span><span class="p">,</span><span class="w"> </span><span class="n">skipping</span><span class="w"> </span><span class="n">upgrade</span><span class="o">:</span><span class="w"> </span><span class="n">urllib3</span><span class="o">&gt;=</span><span class="mf">1.23</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">/</span><span class="n">dist</span><span class="o">-</span><span class="n">packages</span><span class="w"> </span><span class="p">(</span><span class="n">from</span><span class="w"> </span><span class="n">volcengine</span><span class="o">-</span><span class="n">python</span><span class="o">-</span><span class="n">sdk</span><span class="p">[</span><span class="n">ark</span><span class="p">])</span><span class="w"> </span><span class="p">(</span><span class="mf">1.25.8</span><span class="p">)</span>
<span class="n">Requirement</span><span class="w"> </span><span class="n">already</span><span class="w"> </span><span class="n">satisfied</span><span class="p">,</span><span class="w"> </span><span class="n">skipping</span><span class="w"> </span><span class="n">upgrade</span><span class="o">:</span><span class="w"> </span><span class="n">six</span><span class="o">&gt;=</span><span class="mf">1.10</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">/</span><span class="n">dist</span><span class="o">-</span><span class="n">packages</span><span class="w"> </span><span class="p">(</span><span class="n">from</span><span class="w"> </span><span class="n">volcengine</span><span class="o">-</span><span class="n">python</span><span class="o">-</span><span class="n">sdk</span><span class="p">[</span><span class="n">ark</span><span class="p">])</span><span class="w"> </span><span class="p">(</span><span class="mf">1.14.0</span><span class="p">)</span>
<span class="n">Requirement</span><span class="w"> </span><span class="n">already</span><span class="w"> </span><span class="n">satisfied</span><span class="p">,</span><span class="w"> </span><span class="n">skipping</span><span class="w"> </span><span class="n">upgrade</span><span class="o">:</span><span class="w"> </span><span class="n">python</span><span class="o">-</span><span class="n">dateutil</span><span class="o">&gt;=</span><span class="mf">2.1</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">/</span><span class="n">dist</span><span class="o">-</span><span class="n">packages</span><span class="w"> </span><span class="p">(</span><span class="n">from</span><span class="w"> </span><span class="n">volcengine</span><span class="o">-</span><span class="n">python</span><span class="o">-</span><span class="n">sdk</span><span class="p">[</span><span class="n">ark</span><span class="p">])</span><span class="w"> </span><span class="p">(</span><span class="mf">2.7.3</span><span class="p">)</span>
<span class="n">Requirement</span><span class="w"> </span><span class="n">already</span><span class="w"> </span><span class="n">satisfied</span><span class="p">,</span><span class="w"> </span><span class="n">skipping</span><span class="w"> </span><span class="n">upgrade</span><span class="o">:</span><span class="w"> </span><span class="n">certifi</span><span class="o">&gt;=</span><span class="mf">2017.4.17</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">/</span><span class="n">dist</span><span class="o">-</span><span class="n">packages</span><span class="w"> </span><span class="p">(</span><span class="n">from</span><span class="w"> </span><span class="n">volcengine</span><span class="o">-</span><span class="n">python</span><span class="o">-</span><span class="n">sdk</span><span class="p">[</span><span class="n">ark</span><span class="p">])</span><span class="w"> </span><span class="p">(</span><span class="mf">2019.11.28</span><span class="p">)</span>

<span class="n">Collecting</span><span class="w"> </span><span class="n">cryptography</span><span class="o">&lt;</span><span class="mf">43.0.4</span><span class="p">,</span><span class="o">&gt;=</span><span class="mf">43.0.3</span><span class="p">;</span><span class="w"> </span><span class="n">extra</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">"ark"</span>
<span class="w">  </span><span class="n">Downloading</span><span class="w"> </span><span class="n">cryptography</span><span class="mf">-43.0.3</span><span class="o">-</span><span class="n">cp37</span><span class="o">-</span><span class="n">abi3</span><span class="o">-</span><span class="n">manylinux_2_17_x86_64</span><span class="p">.</span><span class="n">manylinux2014_x86_64</span><span class="p">.</span><span class="n">whl</span><span class="w"> </span><span class="p">(</span><span class="mf">4.0</span><span class="w"> </span><span class="n">MB</span><span class="p">)</span>
<span class="w">     </span><span class="o">|</span><span class="err">████████████████████████████████</span><span class="o">|</span><span class="w"> </span><span class="mf">4.0</span><span class="w"> </span><span class="n">MB</span><span class="w"> </span><span class="mf">1.7</span><span class="w"> </span><span class="n">MB</span><span class="o">/</span><span class="n">s</span><span class="w"> </span>
<span class="n">Collecting</span><span class="w"> </span><span class="n">httpx</span><span class="o">&lt;</span><span class="mi">1</span><span class="p">,</span><span class="o">&gt;=</span><span class="mf">0.23.0</span><span class="p">;</span><span class="w"> </span><span class="n">extra</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">"ark"</span>
<span class="w">  </span><span class="n">Downloading</span><span class="w"> </span><span class="n">httpx</span><span class="mf">-0.28.1</span><span class="o">-</span><span class="n">py3</span><span class="o">-</span><span class="n">none</span><span class="o">-</span><span class="n">any</span><span class="p">.</span><span class="n">whl</span><span class="w"> </span><span class="p">(</span><span class="mi">73</span><span class="w"> </span><span class="n">kB</span><span class="p">)</span>
<span class="w">     </span><span class="o">|</span><span class="err">████████████████████████████████</span><span class="o">|</span><span class="w"> </span><span class="mi">73</span><span class="w"> </span><span class="n">kB</span><span class="w"> </span><span class="mf">1.0</span><span class="w"> </span><span class="n">MB</span><span class="o">/</span><span class="n">s</span><span class="w"> </span>
<span class="n">Collecting</span><span class="w"> </span><span class="n">pydantic</span><span class="o">&lt;</span><span class="mi">3</span><span class="p">,</span><span class="o">&gt;=</span><span class="mf">1.9.0</span><span class="p">;</span><span class="w"> </span><span class="n">extra</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">"ark"</span>
<span class="w">  </span><span class="n">Downloading</span><span class="w"> </span><span class="n">pydantic</span><span class="mf">-2.10.4</span><span class="o">-</span><span class="n">py3</span><span class="o">-</span><span class="n">none</span><span class="o">-</span><span class="n">any</span><span class="p">.</span><span class="n">whl</span><span class="w"> </span><span class="p">(</span><span class="mi">431</span><span class="w"> </span><span class="n">kB</span><span class="p">)</span>
<span class="w">     </span><span class="o">|</span><span class="err">████████████████████████████████</span><span class="o">|</span><span class="w"> </span><span class="mi">431</span><span class="w"> </span><span class="n">kB</span><span class="w"> </span><span class="mf">1.6</span><span class="w"> </span><span class="n">MB</span><span class="o">/</span><span class="n">s</span><span class="w"> </span>
<span class="n">Collecting</span><span class="w"> </span><span class="n">anyio</span><span class="o">&lt;</span><span class="mi">5</span><span class="p">,</span><span class="o">&gt;=</span><span class="mf">3.5.0</span><span class="p">;</span><span class="w"> </span><span class="n">extra</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">"ark"</span>
<span class="w">  </span><span class="n">Downloading</span><span class="w"> </span><span class="n">anyio</span><span class="mf">-4.5.2</span><span class="o">-</span><span class="n">py3</span><span class="o">-</span><span class="n">none</span><span class="o">-</span><span class="n">any</span><span class="p">.</span><span class="n">whl</span><span class="w"> </span><span class="p">(</span><span class="mi">89</span><span class="w"> </span><span class="n">kB</span><span class="p">)</span>
<span class="w">     </span><span class="o">|</span><span class="err">████████████████████████████████</span><span class="o">|</span><span class="w"> </span><span class="mi">89</span><span class="w"> </span><span class="n">kB</span><span class="w"> </span><span class="mf">1.8</span><span class="w"> </span><span class="n">MB</span><span class="o">/</span><span class="n">s</span><span class="w"> </span>
<span class="n">Collecting</span><span class="w"> </span><span class="n">cffi</span><span class="o">&gt;=</span><span class="mf">1.12</span><span class="p">;</span><span class="w"> </span><span class="n">platform_python_implementation</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="s">"PyPy"</span>
<span class="w">  </span><span class="n">Downloading</span><span class="w"> </span><span class="n">cffi</span><span class="mf">-1.17.1</span><span class="o">-</span><span class="n">cp38</span><span class="o">-</span><span class="n">cp38</span><span class="o">-</span><span class="n">manylinux_2_17_x86_64</span><span class="p">.</span><span class="n">manylinux2014_x86_64</span><span class="p">.</span><span class="n">whl</span><span class="w"> </span><span class="p">(</span><span class="mi">446</span><span class="w"> </span><span class="n">kB</span><span class="p">)</span>
<span class="w">     </span><span class="o">|</span><span class="err">████████████████████████████████</span><span class="o">|</span><span class="w"> </span><span class="mi">446</span><span class="w"> </span><span class="n">kB</span><span class="w"> </span><span class="mf">1.2</span><span class="w"> </span><span class="n">MB</span><span class="o">/</span><span class="n">s</span><span class="w"> </span>
<span class="n">Collecting</span><span class="w"> </span><span class="n">httpcore</span><span class="o">==</span><span class="mf">1.</span><span class="o">*</span>
<span class="w">  </span><span class="n">Downloading</span><span class="w"> </span><span class="n">httpcore</span><span class="mf">-1.0.7</span><span class="o">-</span><span class="n">py3</span><span class="o">-</span><span class="n">none</span><span class="o">-</span><span class="n">any</span><span class="p">.</span><span class="n">whl</span><span class="w"> </span><span class="p">(</span><span class="mi">78</span><span class="w"> </span><span class="n">kB</span><span class="p">)</span>
<span class="w">     </span><span class="o">|</span><span class="err">████████████████████████████████</span><span class="o">|</span><span class="w"> </span><span class="mi">78</span><span class="w"> </span><span class="n">kB</span><span class="w"> </span><span class="mf">1.8</span><span class="w"> </span><span class="n">MB</span><span class="o">/</span><span class="n">s</span><span class="w"> </span>
<span class="n">Requirement</span><span class="w"> </span><span class="n">already</span><span class="w"> </span><span class="n">satisfied</span><span class="p">,</span><span class="w"> </span><span class="n">skipping</span><span class="w"> </span><span class="n">upgrade</span><span class="o">:</span><span class="w"> </span><span class="n">idna</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">/</span><span class="n">dist</span><span class="o">-</span><span class="n">packages</span><span class="w"> </span><span class="p">(</span><span class="n">from</span><span class="w"> </span><span class="n">httpx</span><span class="o">&lt;</span><span class="mi">1</span><span class="p">,</span><span class="o">&gt;=</span><span class="mf">0.23.0</span><span class="p">;</span><span class="w"> </span><span class="n">extra</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">"ark"</span><span class="o">-&gt;</span><span class="n">volcengine</span><span class="o">-</span><span class="n">python</span><span class="o">-</span><span class="n">sdk</span><span class="p">[</span><span class="n">ark</span><span class="p">])</span><span class="w"> </span><span class="p">(</span><span class="mf">2.8</span><span class="p">)</span>

<span class="n">Collecting</span><span class="w"> </span><span class="n">pydantic</span><span class="o">-</span><span class="n">core</span><span class="o">==</span><span class="mf">2.27.2</span>
<span class="w">  </span><span class="n">Downloading</span><span class="w"> </span><span class="n">pydantic_core</span><span class="mf">-2.27.2</span><span class="o">-</span><span class="n">cp38</span><span class="o">-</span><span class="n">cp38</span><span class="o">-</span><span class="n">manylinux_2_17_x86_64</span><span class="p">.</span><span class="n">manylinux2014_x86_64</span><span class="p">.</span><span class="n">whl</span><span class="w"> </span><span class="p">(</span><span class="mf">2.0</span><span class="w"> </span><span class="n">MB</span><span class="p">)</span>
<span class="w">     </span><span class="o">|</span><span class="err">████████████████████████████████</span><span class="o">|</span><span class="w"> </span><span class="mf">2.0</span><span class="w"> </span><span class="n">MB</span><span class="w"> </span><span class="mf">1.0</span><span class="w"> </span><span class="n">MB</span><span class="o">/</span><span class="n">s</span><span class="w"> </span>
<span class="n">Collecting</span><span class="w"> </span><span class="n">typing</span><span class="o">-</span><span class="n">extensions</span><span class="o">&gt;=</span><span class="mf">4.12.2</span>
<span class="w">  </span><span class="n">Downloading</span><span class="w"> </span><span class="n">typing_extensions</span><span class="mf">-4.12.2</span><span class="o">-</span><span class="n">py3</span><span class="o">-</span><span class="n">none</span><span class="o">-</span><span class="n">any</span><span class="p">.</span><span class="n">whl</span><span class="w"> </span><span class="p">(</span><span class="mi">37</span><span class="w"> </span><span class="n">kB</span><span class="p">)</span>
<span class="n">Collecting</span><span class="w"> </span><span class="n">annotated</span><span class="o">-</span><span class="n">types</span><span class="o">&gt;=</span><span class="mf">0.6.0</span>
<span class="w">  </span><span class="n">Downloading</span><span class="w"> </span><span class="n">annotated_types</span><span class="mf">-0.7.0</span><span class="o">-</span><span class="n">py3</span><span class="o">-</span><span class="n">none</span><span class="o">-</span><span class="n">any</span><span class="p">.</span><span class="n">whl</span><span class="w"> </span><span class="p">(</span><span class="mi">13</span><span class="w"> </span><span class="n">kB</span><span class="p">)</span>
<span class="n">Collecting</span><span class="w"> </span><span class="n">exceptiongroup</span><span class="o">&gt;=</span><span class="mf">1.0.2</span><span class="p">;</span><span class="w"> </span><span class="n">python_version</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="s">"3.11"</span>
<span class="w">  </span><span class="n">Downloading</span><span class="w"> </span><span class="n">exceptiongroup</span><span class="mf">-1.2.2</span><span class="o">-</span><span class="n">py3</span><span class="o">-</span><span class="n">none</span><span class="o">-</span><span class="n">any</span><span class="p">.</span><span class="n">whl</span><span class="w"> </span><span class="p">(</span><span class="mi">16</span><span class="w"> </span><span class="n">kB</span><span class="p">)</span>
<span class="n">Collecting</span><span class="w"> </span><span class="n">sniffio</span><span class="o">&gt;=</span><span class="mf">1.1</span>
<span class="w">  </span><span class="n">Downloading</span><span class="w"> </span><span class="n">sniffio</span><span class="mf">-1.3.1</span><span class="o">-</span><span class="n">py3</span><span class="o">-</span><span class="n">none</span><span class="o">-</span><span class="n">any</span><span class="p">.</span><span class="n">whl</span><span class="w"> </span><span class="p">(</span><span class="mi">10</span><span class="w"> </span><span class="n">kB</span><span class="p">)</span>
<span class="n">Collecting</span><span class="w"> </span><span class="n">pycparser</span>
<span class="w">  </span><span class="n">Downloading</span><span class="w"> </span><span class="n">pycparser</span><span class="mf">-2.22</span><span class="o">-</span><span class="n">py3</span><span class="o">-</span><span class="n">none</span><span class="o">-</span><span class="n">any</span><span class="p">.</span><span class="n">whl</span><span class="w"> </span><span class="p">(</span><span class="mi">117</span><span class="w"> </span><span class="n">kB</span><span class="p">)</span>
<span class="w">     </span><span class="o">|</span><span class="err">████████████████████████████████</span><span class="o">|</span><span class="w"> </span><span class="mi">117</span><span class="w"> </span><span class="n">kB</span><span class="w"> </span><span class="mf">2.9</span><span class="w"> </span><span class="n">MB</span><span class="o">/</span><span class="n">s</span><span class="w"> </span>
<span class="n">Collecting</span><span class="w"> </span><span class="n">h11</span><span class="o">&lt;</span><span class="mf">0.15</span><span class="p">,</span><span class="o">&gt;=</span><span class="mf">0.13</span>
<span class="w">  </span><span class="n">Downloading</span><span class="w"> </span><span class="n">h11</span><span class="mf">-0.14.0</span><span class="o">-</span><span class="n">py3</span><span class="o">-</span><span class="n">none</span><span class="o">-</span><span class="n">any</span><span class="p">.</span><span class="n">whl</span><span class="w"> </span><span class="p">(</span><span class="mi">58</span><span class="w"> </span><span class="n">kB</span><span class="p">)</span>
<span class="w">     </span><span class="o">|</span><span class="err">████████████████████████████████</span><span class="o">|</span><span class="w"> </span><span class="mi">58</span><span class="w"> </span><span class="n">kB</span><span class="w"> </span><span class="mf">3.3</span><span class="w"> </span><span class="n">MB</span><span class="o">/</span><span class="n">s</span><span class="w"> </span>
<span class="n">Installing</span><span class="w"> </span><span class="n">collected</span><span class="w"> </span><span class="n">packages</span><span class="o">:</span><span class="w"> </span><span class="n">pycparser</span><span class="p">,</span><span class="w"> </span><span class="n">cffi</span><span class="p">,</span><span class="w"> </span><span class="n">cryptography</span><span class="p">,</span><span class="w"> </span><span class="n">h11</span><span class="p">,</span><span class="w"> </span><span class="n">httpcore</span><span class="p">,</span><span class="w"> </span><span class="n">exceptiongroup</span><span class="p">,</span><span class="w"> </span><span class="n">typing</span><span class="o">-</span><span class="n">extensions</span><span class="p">,</span><span class="w"> </span><span class="n">sniffio</span><span class="p">,</span><span class="w"> </span><span class="n">anyio</span><span class="p">,</span><span class="w"> </span><span class="n">httpx</span><span class="p">,</span><span class="w"> </span><span class="n">pydantic</span><span class="o">-</span><span class="n">core</span><span class="p">,</span><span class="w"> </span><span class="n">annotated</span><span class="o">-</span><span class="n">types</span><span class="p">,</span><span class="w"> </span><span class="n">pydantic</span>
<span class="w">  </span><span class="nl">WARNING</span><span class="p">:</span><span class="w"> </span><span class="n">The</span><span class="w"> </span><span class="n">script</span><span class="w"> </span><span class="n">httpx</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">installed</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="err">'</span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">apple</span><span class="o">/</span><span class="p">.</span><span class="n">local</span><span class="o">/</span><span class="n">bin</span><span class="err">'</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">not</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">PATH</span><span class="p">.</span>
<span class="w">  </span><span class="n">Consider</span><span class="w"> </span><span class="n">adding</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">directory</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">PATH</span><span class="w"> </span><span class="n">or</span><span class="p">,</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">prefer</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">suppress</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">warning</span><span class="p">,</span><span class="w"> </span><span class="n">use</span><span class="w"> </span><span class="o">--</span><span class="n">no</span><span class="o">-</span><span class="n">warn</span><span class="o">-</span><span class="n">script</span><span class="o">-</span><span class="n">location</span><span class="p">.</span>
<span class="n">Successfully</span><span class="w"> </span><span class="n">installed</span><span class="w"> </span><span class="n">annotated</span><span class="o">-</span><span class="n">types</span><span class="mf">-0.7.0</span><span class="w"> </span><span class="n">anyio</span><span class="mf">-4.5.2</span><span class="w"> </span><span class="n">cffi</span><span class="mf">-1.17.1</span><span class="w"> </span><span class="n">cryptography</span><span class="mf">-43.0.3</span><span class="w"> </span><span class="n">exceptiongroup</span><span class="mf">-1.2.2</span><span class="w"> </span><span class="n">h11</span><span class="mf">-0.14.0</span><span class="w"> </span><span class="n">httpcore</span><span class="mf">-1.0.7</span><span class="w"> </span><span class="n">httpx</span><span class="mf">-0.28.1</span><span class="w"> </span><span class="n">pycparser</span><span class="mf">-2.22</span><span class="w"> </span><span class="n">pydantic</span><span class="mf">-2.10.4</span><span class="w"> </span><span class="n">pydantic</span><span class="o">-</span><span class="n">core</span><span class="mf">-2.27.2</span><span class="w"> </span><span class="n">sniffio</span><span class="mf">-1.3.1</span><span class="w"> </span><span class="n">typing</span><span class="o">-</span><span class="n">extensions</span><span class="mf">-4.12.2</span>
</code></pre></div>
<h2 id="_3">测试</h2>
<h3 id="_4">单张图片测试</h3>
<p>vim test.py</p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="nn">os</span>
<span class="c1"># 通过 pip install volcengine-python-sdk[ark] 安装方舟SDK</span>
<span class="kn">from</span> <span class="nn">volcenginesdkarkruntime</span> <span class="kn">import</span> <span class="n">Ark</span>

<span class="c1"># 替换为您的模型推理接入点</span>
<span class="n">model</span><span class="o">=</span><span class="s2">"ep-20250101121404-stw4s"</span>

<span class="c1"># 初始化Ark客户端，从环境变量中读取您的API Key</span>
<span class="n">client</span> <span class="o">=</span> <span class="n">Ark</span><span class="p">(</span>
    <span class="n">api_key</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s1">'ARK_API_KEY'</span><span class="p">),</span>
    <span class="p">)</span>

<span class="c1"># 创建一个对话请求</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">chat</span><span class="o">.</span><span class="n">completions</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
    <span class="c1"># 指定您部署了视觉理解大模型的推理接入点ID</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">model</span><span class="p">,</span>
    <span class="n">messages</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s2">"role"</span><span class="p">:</span> <span class="s2">"user"</span><span class="p">,</span>  <span class="c1"># 指定消息的角色为用户</span>
            <span class="s2">"content"</span><span class="p">:</span> <span class="p">[</span>  <span class="c1"># 消息内容列表</span>
                <span class="p">{</span><span class="s2">"type"</span><span class="p">:</span> <span class="s2">"text"</span><span class="p">,</span> <span class="s2">"text"</span><span class="p">:</span><span class="s2">"这张图片讲了什么？"</span><span class="p">},</span>  <span class="c1"># 文本消息</span>
                <span class="p">{</span>
                    <span class="s2">"type"</span><span class="p">:</span> <span class="s2">"image_url"</span><span class="p">,</span>  <span class="c1"># 图片消息</span>
                    <span class="c1"># 图片的URL，需要大模型进行理解的图片链接</span>
                    <span class="s2">"image_url"</span><span class="p">:</span> <span class="p">{</span><span class="s2">"url"</span><span class="p">:</span>  <span class="s2">"https://www.laumy.tech/wp-content/uploads/2024/12/wp_editor_md_7a3e5882d13fb51eecfaaf7fc8c53b59.jpg"</span><span class="p">}</span>
                <span class="p">},</span>
            <span class="p">],</span>
        <span class="p">}</span>
    <span class="p">],</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">choices</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</code></pre></div>
<p>执行返回结果</p>
<div class="codehilite"><pre><span></span><code><span class="n">python3</span><span class="w"> </span><span class="n">test</span><span class="p">.</span><span class="n">py</span><span class="w"> </span>

<span class="n">Choice</span><span class="p">(</span>
<span class="n">finish_reason</span><span class="o">=</span><span class="err">'</span><span class="n">stop</span><span class="err">'</span><span class="p">,</span><span class="w"> </span>
<span class="n">index</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
<span class="n">logprobs</span><span class="o">=</span><span class="n">None</span><span class="p">,</span><span class="w"> </span>
<span class="n">message</span><span class="o">=</span><span class="n">ChatCompletionMessage</span><span class="p">(</span>
<span class="w">    </span><span class="n">content</span><span class="o">=</span><span class="err">'</span><span class="n">这张图片展示了一个WebRTC</span><span class="err">（</span><span class="n">Web实时通信</span><span class="err">）</span><span class="n">的流程示意图</span><span class="err">，</span><span class="n">涉及到PC</span><span class="err">（</span><span class="n">个人计算机</span><span class="err">）、</span><span class="n">MQTT代理</span><span class="err">（</span><span class="n">mqtt</span><span class="w"> </span><span class="n">broker</span><span class="err">）</span><span class="n">和CEMARA设备</span><span class="err">。</span><span class="n">以下是流程图的主要步骤</span><span class="err">：</span>

<span class="err">\</span><span class="n">n</span><span class="err">\</span><span class="n">n1</span><span class="p">.</span><span class="w"> </span><span class="o">**</span><span class="n">PC端操作</span><span class="o">**</span><span class="err">：</span>
<span class="err">\</span><span class="n">n</span><span class="w">   </span><span class="o">-</span><span class="w"> </span><span class="o">**</span><span class="n">连接和订阅</span><span class="o">**</span><span class="err">：</span><span class="n">PC端首先进行连接</span><span class="err">（</span><span class="n">connect</span><span class="err">），</span><span class="n">然后订阅相关主题</span><span class="err">（</span><span class="s">"webrtc/id/jsonrpc"</span><span class="n">和</span><span class="s">"webrtc/id/jsonrpc-replay"</span><span class="err">）。</span>
<span class="err">\</span><span class="n">n</span><span class="w">   </span><span class="o">-</span><span class="w"> </span><span class="o">**</span><span class="n">发布消息</span><span class="o">**</span><span class="err">：</span><span class="n">PC端发布消息</span><span class="err">（</span><span class="n">pub</span><span class="err">），</span><span class="n">发送</span><span class="s">"offer"</span><span class="n">请求</span><span class="err">（</span><span class="n">offer</span><span class="w"> </span><span class="p">(</span><span class="n">req</span><span class="p">)</span><span class="err">）。</span>
<span class="err">\</span><span class="n">n</span><span class="w">   </span><span class="o">-</span><span class="w"> </span><span class="o">**</span><span class="n">接收消息</span><span class="o">**</span><span class="err">：</span><span class="n">PC端接收来自MQTT代理的消息</span><span class="err">，</span><span class="n">包括</span><span class="s">"message"</span><span class="n">事件和相关的应答</span><span class="err">（</span><span class="n">res</span><span class="err">）。</span>
<span class="err">\</span><span class="n">n</span><span class="w">   </span><span class="o">-</span><span class="w"> </span><span class="o">**</span><span class="n">创建应答</span><span class="o">**</span><span class="err">：</span><span class="n">PC端创建应答</span><span class="err">（</span><span class="n">pc</span><span class="p">.</span><span class="n">createAnswer</span><span class="err">），</span><span class="n">并设置远程描述</span><span class="err">（</span><span class="n">pc</span><span class="p">.</span><span class="n">setRemoteDescription</span><span class="err">）。</span>

<span class="err">\</span><span class="n">n</span><span class="err">\</span><span class="n">n2</span><span class="p">.</span><span class="w"> </span><span class="o">**</span><span class="n">STUN</span><span class="o">/</span><span class="n">TURN服务器交互</span><span class="o">**</span><span class="err">：</span>
<span class="err">\</span><span class="n">n</span><span class="w">   </span><span class="o">-</span><span class="w"> </span><span class="o">**</span><span class="n">STUN</span><span class="o">/</span><span class="n">TURN绑定请求和应答</span><span class="o">**</span><span class="err">：</span><span class="n">在STUN</span><span class="o">/</span><span class="n">TURN服务器上</span><span class="err">，</span><span class="n">PC端发起绑定请求</span><span class="err">（</span><span class="n">binding</span><span class="w"> </span><span class="n">req</span><span class="err">）</span><span class="n">和应答</span><span class="err">（</span><span class="n">binding</span><span class="w"> </span><span class="n">res</span><span class="err">），</span><span class="n">获取SDP</span><span class="err">（</span><span class="n">Session</span><span class="w"> </span><span class="n">Description</span><span class="w"> </span><span class="n">Protocol</span><span class="err">）</span><span class="n">信息</span><span class="err">。</span>
<span class="err">\</span><span class="n">n</span><span class="w">   </span><span class="o">-</span><span class="w"> </span><span class="o">**</span><span class="n">ANSWER请求和应答</span><span class="o">**</span><span class="err">：</span><span class="n">PC端发送ANSWER请求</span><span class="err">（</span><span class="n">anser</span><span class="w"> </span><span class="p">(</span><span class="n">req</span><span class="p">)</span><span class="err">），</span><span class="n">并接收ANSWER应答</span><span class="err">（</span><span class="n">anser</span><span class="w"> </span><span class="p">(</span><span class="n">res</span><span class="p">)</span><span class="err">）。</span>

<span class="err">\</span><span class="n">n</span><span class="err">\</span><span class="n">n3</span><span class="p">.</span><span class="w"> </span><span class="o">**</span><span class="n">检查和连接过程</span><span class="o">**</span><span class="err">：</span>
<span class="err">\</span><span class="n">n</span><span class="w">   </span><span class="o">-</span><span class="w"> </span><span class="o">**</span><span class="n">检查连接</span><span class="o">**</span><span class="err">：</span><span class="n">PC端按照优先级顺序检查连接的顺畅性</span><span class="err">（</span><span class="n">host</span><span class="err">、</span><span class="n">srflx</span><span class="err">、</span><span class="n">relay</span><span class="err">）。</span>
<span class="err">\</span><span class="n">n</span><span class="w">   </span><span class="o">-</span><span class="w"> </span><span class="o">**</span><span class="n">连接完成</span><span class="o">**</span><span class="err">：</span><span class="n">经过一系列的检查和交互</span><span class="err">，</span><span class="n">PC端与CEMARA设备成功连接</span><span class="err">（</span><span class="n">CONNECTED</span><span class="err">）。\</span><span class="n">n</span><span class="err">\</span><span class="n">n4</span><span class="p">.</span><span class="w"> </span><span class="o">**</span><span class="n">数据交互和完成</span><span class="o">**</span><span class="err">：</span>
<span class="err">\</span><span class="n">n</span><span class="w">   </span><span class="o">-</span><span class="w"> </span><span class="o">**</span><span class="n">数据交互</span><span class="o">**</span><span class="err">：</span><span class="n">PC端和CEMARA设备开始进行数据交互</span><span class="err">（</span><span class="n">agent_send和agent_recv</span><span class="err">）。</span>
<span class="err">\</span><span class="n">n</span><span class="w">   </span><span class="o">-</span><span class="w"> </span><span class="o">**</span><span class="n">完成状态</span><span class="o">**</span><span class="err">：</span><span class="n">数据交互完成后</span><span class="err">，</span><span class="n">流程进入</span><span class="err">“</span><span class="n">COMPLETED</span><span class="err">”</span><span class="n">状态</span><span class="err">，</span><span class="n">表示整个WebRTC通信过程结束</span><span class="err">。</span>
<span class="err">\</span><span class="n">n</span><span class="err">\</span><span class="n">n整个流程图清晰地展示了WebRTC通信过程中PC端与MQTT代理以及STUN</span><span class="o">/</span><span class="n">TURN服务器之间的交互过程</span><span class="err">，</span><span class="n">包括连接</span><span class="err">、</span><span class="n">消息发布</span><span class="err">、</span><span class="n">应答接收</span><span class="err">、</span><span class="n">绑定请求</span><span class="err">、</span><span class="n">检查连接等步骤</span><span class="err">，</span><span class="n">最终实现了PC端与CEMARA设备的数据通信</span><span class="err">。'</span><span class="p">,</span><span class="w"> </span><span class="n">role</span><span class="o">=</span><span class="err">'</span><span class="n">assistant</span><span class="err">'</span><span class="p">,</span><span class="w"> </span><span class="n">function_call</span><span class="o">=</span><span class="n">None</span><span class="p">,</span><span class="w"> </span><span class="n">tool_calls</span><span class="o">=</span><span class="n">None</span><span class="p">,</span><span class="w"> </span><span class="n">audio</span><span class="o">=</span><span class="n">None</span>
<span class="p">)</span>
<span class="p">)</span>
</code></pre></div></div>
  <div class="post-nav">
    <a class="prev" href="../../2条命令本地部署deepseek.html">← 2条命令本地部署deepseek</a>
    <a class="next" href="../../macbook上ubuntu虚拟机共享.html">MacBook上ubuntu虚拟机共享 →</a>
  </div>
</article>

      </section>

      <aside class="right-panel">
        
      </aside>
    </main>

    <footer class="site-footer">
      <div class="container">Copyright ©2022-2025 laumy 版权所有</div>
    </footer>

    <script src="../../assets/site.js"></script>
  </body>
  </html>

