<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>lerobot搭建 - Laumy的技术栈</title>
    <link rel="stylesheet" href="assets/style.css">
    <!-- MathJax支持LaTeX数学公式 -->
    <script>
      window.MathJax = {
        tex: {
          inlineMath: [['$', '$'], ['\\(', '\\)']],
          displayMath: [['$$', '$$'], ['\\[', '\\]']],
          processEscapes: true,
          processEnvironments: true
        },
        options: {
          ignoreHtmlClass: 'tex2jax_ignore',
          processHtmlClass: 'tex2jax_process'
        }
      };
    </script>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
  </head>
  <body>
    <header class="site-header">
      <div class="container">
        <a class="logo" href="">Laumy的技术栈</a>
        <div class="search">
          <input id="search-input" type="text" placeholder="输入关键词回车搜索">
        </div>
        <div class="theme-toggle" title="切换主题" id="theme-toggle">☾</div>
        <nav class="top-nav">
          <div class="nav-item"><a href="">首页</a></div>
        </nav>
      </div>
    </header>

    <main class="container layout">
      <aside class="left-nav">
        
        <div class="card">
          <div class="card-title">文章目录</div>
          <nav id="toc"><ul><li><a href="#_1">设备查询</a><ul></ul></li><li><a href="#_2">机器标定</a><ul><li><a href="#_3">从臂标定</a></li><li><a href="#_4">主臂标定</a></li></ul></li><li><a href="#_5">示教</a><ul></ul></li><li><a href="#_6">数据采集</a><ul></ul></li><li><a href="#_7">训练</a><ul></ul></li><li><a href="#_8">测试</a><ul></ul></li><li><a href="#_9">其他（废弃）</a><ul><li><a href="#mac">mac</a></li><li><a href="#windows">windows</a></li><li><a href="#unbuntu">unbuntu</a></li></ul></li></ul></nav>
        </div>
        
      </aside>

      <section class="content">
        
<article class="card post">
  <h1>lerobot搭建</h1>
  <div class="meta">2025-07-23 · ai</div>
  <div class="post-content"><h2 id="_1">设备查询</h2>
<p>本文是记录ubuntu系统lerobot试验的快捷命令，方便开始负责执行设备，不会介绍为什么？</p>
<div class="codehilite"><pre><span></span><code><span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">lerobot</span><span class="o">.</span><span class="n">find_port</span>
<span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">lerobot</span><span class="o">.</span><span class="n">find_cameras</span>
</code></pre></div>
<h2 id="_2">机器标定</h2>
<h3 id="_3">从臂标定</h3>
<div class="codehilite"><pre><span></span><code><span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">lerobot</span><span class="o">.</span><span class="n">calibrate</span> \
    <span class="o">--</span><span class="n">robot</span><span class="o">.</span><span class="n">type</span><span class="o">=</span><span class="n">so101_follower</span> \
    <span class="o">--</span><span class="n">robot</span><span class="o">.</span><span class="n">port</span><span class="o">=/</span><span class="n">dev</span><span class="o">/</span><span class="n">ttyACM0</span> \
    <span class="o">--</span><span class="n">robot</span><span class="o">.</span><span class="n">id</span><span class="o">=</span><span class="n">R12252801</span>
</code></pre></div>
<h3 id="_4">主臂标定</h3>
<div class="codehilite"><pre><span></span><code><span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">lerobot</span><span class="o">.</span><span class="n">calibrate</span> \
    <span class="o">--</span><span class="n">teleop</span><span class="o">.</span><span class="n">type</span><span class="o">=</span><span class="n">so101_leader</span> \
    <span class="o">--</span><span class="n">teleop</span><span class="o">.</span><span class="n">port</span><span class="o">=/</span><span class="n">dev</span><span class="o">/</span><span class="n">ttyACM1</span> \
    <span class="o">--</span><span class="n">teleop</span><span class="o">.</span><span class="n">id</span><span class="o">=</span><span class="n">R07252608</span>
</code></pre></div>
<p>标定的文件路径默认存储在/home/laumy/.cache/huggingface/lerobot/calibration。如果要更改路径。</p>
<div class="codehilite"><pre><span></span><code><span class="o">--</span><span class="n">robot</span><span class="o">.</span><span class="n">calibration_dir</span><span class="o">=/</span><span class="n">home</span><span class="o">/</span><span class="n">laumy</span><span class="o">/</span><span class="n">lerobot</span><span class="o">/</span><span class="n">calibrations</span>
<span class="o">--</span><span class="n">teleop</span><span class="o">.</span><span class="n">calibration_dir</span><span class="o">=/</span><span class="n">home</span><span class="o">/</span><span class="n">laumy</span><span class="o">/</span><span class="n">lerobot</span><span class="o">/</span><span class="n">calibrations</span>
</code></pre></div>
<p>如果指定了路径，后续的代码都需要指定。</p>
<h2 id="_5">示教</h2>
<div class="codehilite"><pre><span></span><code><span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">lerobot</span><span class="o">.</span><span class="n">teleoperate</span> \
    <span class="o">--</span><span class="n">robot</span><span class="o">.</span><span class="n">type</span><span class="o">=</span><span class="n">so101_follower</span> \
    <span class="o">--</span><span class="n">robot</span><span class="o">.</span><span class="n">port</span><span class="o">=/</span><span class="n">dev</span><span class="o">/</span><span class="n">ttyACM0</span> \
    <span class="o">--</span><span class="n">robot</span><span class="o">.</span><span class="n">id</span><span class="o">=</span><span class="n">R12252801</span> \
    <span class="o">--</span><span class="n">teleop</span><span class="o">.</span><span class="n">type</span><span class="o">=</span><span class="n">so101_leader</span> \
    <span class="o">--</span><span class="n">teleop</span><span class="o">.</span><span class="n">port</span><span class="o">=/</span><span class="n">dev</span><span class="o">/</span><span class="n">ttyACM1</span> \
    <span class="o">--</span><span class="n">teleop</span><span class="o">.</span><span class="n">id</span><span class="o">=</span><span class="n">R07252608</span>
</code></pre></div>
<h2 id="_6">数据采集</h2>
<div class="codehilite"><pre><span></span><code><span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">lerobot</span><span class="o">.</span><span class="n">record</span> \
    <span class="o">--</span><span class="n">robot</span><span class="o">.</span><span class="n">disable_torque_on_disconnect</span><span class="o">=</span><span class="n">true</span> \
    <span class="o">--</span><span class="n">robot</span><span class="o">.</span><span class="n">type</span><span class="o">=</span><span class="n">so101_follower</span> \
    <span class="o">--</span><span class="n">robot</span><span class="o">.</span><span class="n">port</span><span class="o">=/</span><span class="n">dev</span><span class="o">/</span><span class="n">ttyACM0</span> \
    <span class="o">--</span><span class="n">robot</span><span class="o">.</span><span class="n">id</span><span class="o">=</span><span class="n">R12252801</span> \
    <span class="o">--</span><span class="n">robot</span><span class="o">.</span><span class="n">cameras</span><span class="o">=</span><span class="s2">"{ handeye: {type: opencv, index_or_path: 6, width: 640, height: 480, fps: 30}, fixed: {type: opencv, index_or_path: 0, width: 640, height: 480, fps: 30}}"</span> \
    <span class="o">--</span><span class="n">teleop</span><span class="o">.</span><span class="n">type</span><span class="o">=</span><span class="n">so101_leader</span> \
    <span class="o">--</span><span class="n">teleop</span><span class="o">.</span><span class="n">port</span><span class="o">=/</span><span class="n">dev</span><span class="o">/</span><span class="n">ttyACM1</span> \
    <span class="o">--</span><span class="n">teleop</span><span class="o">.</span><span class="n">id</span><span class="o">=</span><span class="n">R07252608</span> \
    <span class="o">--</span><span class="n">dataset</span><span class="o">.</span><span class="n">repo_id</span><span class="o">=</span><span class="n">laumy</span><span class="o">/</span><span class="n">record</span><span class="o">-</span><span class="mi">07271148</span>\
    <span class="o">--</span><span class="n">dataset</span><span class="o">.</span><span class="n">num_episodes</span><span class="o">=</span><span class="mi">10</span> \
    <span class="o">--</span><span class="n">dataset</span><span class="o">.</span><span class="n">reset_time_s</span><span class="o">=</span><span class="mi">5</span> \
    <span class="o">--</span><span class="n">dataset</span><span class="o">.</span><span class="n">push_to_hub</span><span class="o">=</span><span class="n">false</span> \
    <span class="o">--</span><span class="n">dataset</span><span class="o">.</span><span class="n">single_task</span><span class="o">=</span><span class="s2">"Grab the cube"</span> \
    <span class="o">--</span><span class="n">display_data</span><span class="o">=</span><span class="n">true</span>
</code></pre></div>
<p>repo_id必现为"用户名/数据集名"格式，代码中会检测是否有"/"。</p>
<p>数据存储默认的路径为/home/laumy/.cache/huggingface/lerobot/laumy/record-07271148如果要修改路径的话，加上下面参数。</p>
<div class="codehilite"><pre><span></span><code><span class="o">--</span><span class="n">dataset</span><span class="o">.</span><span class="n">root</span><span class="o">=/</span><span class="n">home</span><span class="o">/</span><span class="n">laumy</span><span class="o">/</span><span class="n">lerobot</span><span class="o">/</span><span class="n">data</span><span class="o">/</span><span class="n">record_07271148</span>
</code></pre></div>
<p>如果要继续上一次的录制，可以添加在上面命令基础上加上： --resume=true</p>
<p>如果数据采集过程中，突然异常终止，无法恢复报错如下时。</p>
<div class="codehilite"><pre><span></span><code><span class="n">Traceback</span><span class="w"> </span><span class="p">(</span><span class="n">most</span><span class="w"> </span><span class="n">recent</span><span class="w"> </span><span class="n">call</span><span class="w"> </span><span class="n">last</span><span class="p">)</span><span class="o">:</span>
<span class="w">  </span><span class="n">File</span><span class="w"> </span><span class="s">"/home/laumy/lerobot/./src/lerobot/scripts/train.py"</span><span class="p">,</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="mi">291</span><span class="p">,</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="w">    </span><span class="n">train</span><span class="p">()</span>
<span class="w">  </span><span class="n">File</span><span class="w"> </span><span class="s">"/home/laumy/lerobot/src/lerobot/configs/parser.py"</span><span class="p">,</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="mi">226</span><span class="p">,</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="n">wrapper_inner</span>
<span class="w">    </span><span class="n">response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fn</span><span class="p">(</span><span class="n">cfg</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="w"> </span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="w">  </span><span class="n">File</span><span class="w"> </span><span class="s">"/home/laumy/lerobot/./src/lerobot/scripts/train.py"</span><span class="p">,</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="mi">128</span><span class="p">,</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="n">train</span>
<span class="w">    </span><span class="n">dataset</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">make_dataset</span><span class="p">(</span><span class="n">cfg</span><span class="p">)</span>
<span class="w">  </span><span class="n">File</span><span class="w"> </span><span class="s">"/home/laumy/lerobot/src/lerobot/datasets/factory.py"</span><span class="p">,</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="mi">90</span><span class="p">,</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="n">make_dataset</span>
<span class="w">    </span><span class="n">dataset</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LeRobotDataset</span><span class="p">(</span>
<span class="w">  </span><span class="n">File</span><span class="w"> </span><span class="s">"/home/laumy/lerobot/src/lerobot/datasets/lerobot_dataset.py"</span><span class="p">,</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="mi">489</span><span class="p">,</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="n">__init__</span>
<span class="w">    </span><span class="n">check_timestamps_sync</span><span class="p">(</span><span class="n">timestamps</span><span class="p">,</span><span class="w"> </span><span class="n">episode_indices</span><span class="p">,</span><span class="w"> </span><span class="n">ep_data_index_np</span><span class="p">,</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">fps</span><span class="p">,</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">tolerance_s</span><span class="p">)</span>
<span class="w">  </span><span class="n">File</span><span class="w"> </span><span class="s">"/home/laumy/lerobot/src/lerobot/datasets/utils.py"</span><span class="p">,</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="mi">585</span><span class="p">,</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="n">check_timestamps_sync</span>
<span class="w">    </span><span class="n">raise</span><span class="w"> </span><span class="n">ValueError</span><span class="p">(</span>
<span class="nl">ValueError</span><span class="p">:</span><span class="w"> </span><span class="n">One</span><span class="w"> </span><span class="n">or</span><span class="w"> </span><span class="n">several</span><span class="w"> </span><span class="n">timestamps</span><span class="w"> </span><span class="n">unexpectedly</span><span class="w"> </span><span class="n">violate</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">tolerance</span><span class="w"> </span><span class="n">inside</span><span class="w"> </span><span class="n">episode</span><span class="w"> </span><span class="n">range</span><span class="p">.</span>
<span class="w">                </span><span class="n">This</span><span class="w"> </span><span class="n">might</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">due</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">synchronization</span><span class="w"> </span><span class="n">issues</span><span class="w"> </span><span class="n">during</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="n">collection</span><span class="p">.</span>

<span class="p">[{</span><span class="err">'</span><span class="n">diff</span><span class="err">'</span><span class="o">:</span><span class="w"> </span><span class="n">np</span><span class="p">.</span><span class="n">float32</span><span class="p">(</span><span class="mf">-15.966666</span><span class="p">),</span>
<span class="w">  </span><span class="err">'</span><span class="n">episode_index</span><span class="err">'</span><span class="o">:</span><span class="w"> </span><span class="mi">90</span><span class="p">,</span>
<span class="w">  </span><span class="err">'</span><span class="n">timestamps</span><span class="err">'</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="n">np</span><span class="p">.</span><span class="n">float32</span><span class="p">(</span><span class="mf">15.966666</span><span class="p">),</span><span class="w"> </span><span class="n">np</span><span class="p">.</span><span class="n">float32</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)]}]</span>
</code></pre></div>
<p>解决办法就是到数据集路径下~/.cache/huggingface/lerobot/laumy/record-07261516/检查数据，一般就是数据集不匹配了，打开data和videos下面的数据，看看数量是否和meta里面的jsonl对齐了，因为程序采集过程中异常终止，可能只写了data目录或videos目录，但是meta目录下没来得及写就崩溃退出，把最新的一组数据删除了并把meta下面的所有文件数量对齐就可以了。</p>
<p><a href="https://www.laumy.tech/wp-content/uploads/2025/07/wp_editor_md_2944f77882efd633b66bbfa1c53a4df5.jpg"><img alt="" src="assets/doc/04-ai/lerobot/lerobot搭建/images/wp_editor_md_2944f77882efd633b66bbfa1c53a4df5.jpg"/></a></p>
<p>需要注意的时，info.json中的数据要特别进行修改，下面是需要修改info.json的地方。</p>
<div class="codehilite"><pre><span></span><code><span class="p">{</span>
    <span class="s2">"codebase_version"</span><span class="p">:</span> <span class="s2">"v2.1"</span><span class="p">,</span>
    <span class="s2">"robot_type"</span><span class="p">:</span> <span class="s2">"so101_follower"</span><span class="p">,</span>
    <span class="s2">"total_episodes"</span><span class="p">:</span> <span class="mi">54</span><span class="p">,</span>                <span class="o">------</span><span class="n">采集的周期</span>
    <span class="s2">"total_frames"</span><span class="p">:</span> <span class="mi">21243</span><span class="p">,</span>             <span class="o">------</span><span class="n">采集的总长度</span><span class="err">，</span><span class="n">是episodes</span><span class="o">.</span><span class="n">jsonl的总和</span><span class="err">，</span><span class="n">这个可以通过后面的脚步来计算确认</span>
    <span class="s2">"total_tasks"</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s2">"total_videos"</span><span class="p">:</span> <span class="mi">108</span><span class="p">,</span>                  <span class="o">-----</span><span class="n">总的视频数量</span><span class="err">，</span><span class="n">一般是episodes</span> <span class="o">*</span> <span class="mi">2</span>
    <span class="s2">"total_chunks"</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s2">"chunks_size"</span><span class="p">:</span> <span class="mi">1000</span><span class="p">,</span>
    <span class="s2">"fps"</span><span class="p">:</span> <span class="mi">30</span><span class="p">,</span>
    <span class="s2">"splits"</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">"train"</span><span class="p">:</span> <span class="s2">"0:54"</span>                       <span class="o">-----</span><span class="n">用于划分给训练集的数据</span><span class="err">，</span><span class="n">后面的数据一般要和total_episodes一致</span><span class="err">。</span>
    <span class="p">},</span>
</code></pre></div>
<p>如果meta/info.json中total_frames是所有视频的总帧数，是从meta/episodes.jsonl中所有的length字段获取的总和，如果做了调整要重新计算更新一下这个total_frames。下面是重新计算的脚步。</p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">argparse</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>

<span class="k">def</span> <span class="nf">calibrate_total_frames</span><span class="p">(</span><span class="n">dataset_root</span><span class="p">):</span>
    <span class="n">dataset_root</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">dataset_root</span><span class="p">)</span>
    <span class="c1"># 手动指定 INFO_PATH 和 EPISODES_PATH</span>
    <span class="n">info_path</span> <span class="o">=</span> <span class="n">dataset_root</span> <span class="o">/</span> <span class="s2">"info.json"</span>  <span class="c1"># 替换为实际的元数据文件路径</span>
    <span class="n">episodes_path</span> <span class="o">=</span> <span class="n">dataset_root</span> <span class="o">/</span> <span class="s2">"episodes.jsonl"</span>  <span class="c1"># 替换为实际的剧集信息文件路径</span>

    <span class="c1"># 检查元数据文件是否存在</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">info_path</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Metadata file </span><span class="si">{</span><span class="n">info_path</span><span class="si">}</span><span class="s2"> does not exist."</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="c1"># 检查剧集信息文件是否存在</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">episodes_path</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Episodes file </span><span class="si">{</span><span class="n">episodes_path</span><span class="si">}</span><span class="s2"> does not exist."</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="c1"># 加载元数据python ./src/lerobot/scripts/train.py \</span>
  <span class="o">--</span><span class="n">dataset</span><span class="o">.</span><span class="n">repo_id</span><span class="o">=</span><span class="err">$</span><span class="p">{</span><span class="n">HF_USER</span><span class="p">}</span><span class="o">/</span><span class="n">record</span><span class="o">-</span><span class="mi">07271539</span> \
  <span class="o">--</span><span class="n">policy</span><span class="o">.</span><span class="n">type</span><span class="o">=</span><span class="n">act</span> \
  <span class="o">--</span><span class="n">output_dir</span><span class="o">=</span><span class="n">outputs</span><span class="o">/</span><span class="n">train</span><span class="o">/</span><span class="n">weigh_07271539</span> \
  <span class="o">--</span><span class="n">job_name</span><span class="o">=</span><span class="n">act_so101_test</span> \
  <span class="o">--</span><span class="n">policy</span><span class="o">.</span><span class="n">device</span><span class="o">=</span><span class="n">cuda</span> \
  <span class="o">--</span><span class="n">policy</span><span class="o">.</span><span class="n">push_to_hub</span><span class="o">=</span><span class="n">false</span> \
  <span class="o">--</span><span class="n">wandb</span><span class="o">.</span><span class="n">enable</span><span class="o">=</span><span class="n">false</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">info_path</span><span class="p">,</span> <span class="s1">'r'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">info</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

    <span class="c1"># 重新计算 total_frames</span>
    <span class="n">total_frames</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">episodes_path</span><span class="p">,</span> <span class="s1">'r'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">episode</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
            <span class="n">total_frames</span> <span class="o">+=</span> <span class="n">episode</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">'length'</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

    <span class="c1"># 更新元数据</span>
<span class="c1">#    info["total_frames"] = total_frames</span>
<span class="c1">#    with open(info_path, 'w') as f:</span>
<span class="c1">#        json.dump(info, f, indent=4)</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Total frames calibrated to </span><span class="si">{</span><span class="n">total_frames</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">"__main__"</span><span class="p">:</span>
    <span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s1">'Calibrate total frames in dataset metadata.'</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">'dataset_root'</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">'Root path of the dataset'</span><span class="p">)</span>
    <span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>
    <span class="n">calibrate_total_frames</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">dataset_root</span><span class="p">)</span>
</code></pre></div>
<h2 id="_7">训练</h2>
<div class="codehilite"><pre><span></span><code><span class="n">python</span> <span class="o">./</span><span class="n">src</span><span class="o">/</span><span class="n">lerobot</span><span class="o">/</span><span class="n">scripts</span><span class="o">/</span><span class="n">train</span><span class="o">.</span><span class="n">py</span> \
  <span class="o">--</span><span class="n">dataset</span><span class="o">.</span><span class="n">repo_id</span><span class="o">=</span><span class="n">laumy</span><span class="o">/</span><span class="n">record</span><span class="o">-</span><span class="mi">07271539</span> \
  <span class="o">--</span><span class="n">policy</span><span class="o">.</span><span class="n">type</span><span class="o">=</span><span class="n">act</span> \
  <span class="o">--</span><span class="n">output_dir</span><span class="o">=</span><span class="n">outputs</span><span class="o">/</span><span class="n">train</span><span class="o">/</span><span class="n">weigh_07271539</span> \
  <span class="o">--</span><span class="n">job_name</span><span class="o">=</span><span class="n">act_so101_test</span> \
  <span class="o">--</span><span class="n">policy</span><span class="o">.</span><span class="n">device</span><span class="o">=</span><span class="n">cuda</span> \
  <span class="o">--</span><span class="n">policy</span><span class="o">.</span><span class="n">push_to_hub</span><span class="o">=</span><span class="n">false</span> \
  <span class="o">--</span><span class="n">wandb</span><span class="o">.</span><span class="n">enable</span><span class="o">=</span><span class="n">false</span>
</code></pre></div>
<p>训练过程如果不小心终止了，执行下面命令可以接着上次的训练。</p>
<div class="codehilite"><pre><span></span><code><span class="n">python</span> <span class="o">./</span><span class="n">src</span><span class="o">/</span><span class="n">lerobot</span><span class="o">/</span><span class="n">scripts</span><span class="o">/</span><span class="n">train</span><span class="o">.</span><span class="n">py</span> \
  <span class="o">--</span><span class="n">config_path</span><span class="o">=</span><span class="n">outputs</span><span class="o">/</span><span class="n">train</span><span class="o">/</span><span class="n">weigh_07271539</span><span class="o">/</span><span class="n">checkpoints</span><span class="o">/</span><span class="n">last</span><span class="o">/</span><span class="n">pretrained_model</span><span class="o">/</span><span class="n">train_config</span><span class="o">.</span><span class="n">json</span> \
  <span class="o">--</span><span class="n">resume</span><span class="o">=</span><span class="n">true</span> <span class="o">--</span><span class="n">steps</span><span class="o">=</span><span class="mi">200000</span>
</code></pre></div>
<p>--steps参数表示迭代次数，这里表示200K次。</p>
<h2 id="_8">测试</h2>
<div class="codehilite"><pre><span></span><code><span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">lerobot</span><span class="o">.</span><span class="n">record</span>  \
  <span class="o">--</span><span class="n">robot</span><span class="o">.</span><span class="n">type</span><span class="o">=</span><span class="n">so101_follower</span> \
  <span class="o">--</span><span class="n">robot</span><span class="o">.</span><span class="n">disable_torque_on_disconnect</span><span class="o">=</span><span class="n">true</span> \
  <span class="o">--</span><span class="n">robot</span><span class="o">.</span><span class="n">port</span><span class="o">=/</span><span class="n">dev</span><span class="o">/</span><span class="n">ttyACM0</span> \
<span class="o">--</span><span class="n">robot</span><span class="o">.</span><span class="n">cameras</span><span class="o">=</span><span class="s2">"{ handeye: {type: opencv, index_or_path: 6, width: 640, height: 480, fps: 30}, fixed: {type: opencv, index_or_path: 0, width: 640, height: 480, fps: 30}}"</span> \
  <span class="o">--</span><span class="n">robot</span><span class="o">.</span><span class="n">id</span><span class="o">=</span><span class="n">R12252801</span> \
  <span class="o">--</span><span class="n">display_data</span><span class="o">=</span><span class="n">false</span> \
  <span class="o">--</span><span class="n">dataset</span><span class="o">.</span><span class="n">single_task</span><span class="o">=</span><span class="s2">"Put brick into the box"</span> \
  <span class="o">--</span><span class="n">policy</span><span class="o">.</span><span class="n">path</span><span class="o">=</span><span class="n">outputs</span><span class="o">/</span><span class="n">weigh_07280842</span><span class="o">/</span><span class="n">pretrained_model</span> \
  <span class="o">--</span><span class="n">dataset</span><span class="o">.</span><span class="n">episode_time_s</span><span class="o">=</span><span class="mi">240</span>  \
  <span class="o">--</span><span class="n">dataset</span><span class="o">.</span><span class="n">repo_id</span><span class="o">=</span><span class="n">laumy</span><span class="o">/</span><span class="n">eval_so101_07280842</span>

<span class="n">默认录制时长是60s</span><span class="err">，</span><span class="mi">60</span><span class="n">S后会停止</span><span class="err">，</span><span class="n">如果要改长加上</span><span class="o">--</span><span class="n">dataset</span><span class="o">.</span><span class="n">episode_time_s</span><span class="o">=</span><span class="mi">640</span>
</code></pre></div>
<div class="codehilite"><pre><span></span><code><span class="err">class</span><span class="w"> </span><span class="err">ACTCo</span><span class="kc">nf</span><span class="err">ig(PreTrai</span><span class="kc">ne</span><span class="err">dCo</span><span class="kc">nf</span><span class="err">ig)</span><span class="p">:</span>
<span class="w">    </span><span class="kc">n</span><span class="err">_obs_s</span><span class="kc">te</span><span class="err">ps</span><span class="p">:</span><span class="w"> </span><span class="err">i</span><span class="kc">nt</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">1</span>
<span class="w">    </span><span class="err">chu</span><span class="kc">n</span><span class="err">k_size</span><span class="p">:</span><span class="w"> </span><span class="err">i</span><span class="kc">nt</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">100</span>
<span class="w">    </span><span class="kc">n</span><span class="err">_ac</span><span class="kc">t</span><span class="err">io</span><span class="kc">n</span><span class="err">_s</span><span class="kc">te</span><span class="err">ps</span><span class="p">:</span><span class="w"> </span><span class="err">i</span><span class="kc">nt</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">1</span>
</code></pre></div>
<ul>
<li>n_obs_steps:传递给策略的观测时间窗口大小，具体是指包含当前步骤在内的连续观测步数。也就是说我要观测几步动作来预测接下来的动作。</li>
<li>chunk_size=100: 动作预测分块大小，为单次模型前向传播预测的动作序列总长度（以环境步数为单位），简单理解就是预测的动作步数，实际执行的动作会从这里面选择。</li>
<li>n_action_steps：从预测的动作分块中实际执行的步数，所以必须满足 n_action_steps ≤ chunk_size。</li>
</ul>
<div class="codehilite"><pre><span></span><code><span class="err">观测序列</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="p">[</span><span class="err">O_</span><span class="kc">t</span><span class="mi">-</span><span class="kc">n</span><span class="p">,</span><span class="w"> </span><span class="err">...</span><span class="p">,</span><span class="w"> </span><span class="err">O_</span><span class="kc">t</span><span class="p">]</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="err">策略网络</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="p">[</span><span class="err">A</span><span class="mf">1...</span><span class="err">A</span><span class="mi">100</span><span class="p">]</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="err">执行</span><span class="p">[</span><span class="err">A</span><span class="mf">1...</span><span class="err">A</span><span class="mi">50</span><span class="p">]</span>
<span class="w">                    </span><span class="err">↑</span><span class="w">                     </span><span class="err">↑</span><span class="w">                               </span><span class="err">↑</span><span class="w">                             </span><span class="err">↑</span>
<span class="w">        </span><span class="kc">n</span><span class="err">_obs_s</span><span class="kc">te</span><span class="err">ps=</span><span class="mi">3</span><span class="w">                             </span><span class="err">chu</span><span class="kc">n</span><span class="err">k_size=</span><span class="mi">1</span><span class="w">         </span><span class="kc">n</span><span class="err">_ac</span><span class="kc">t</span><span class="err">io</span><span class="kc">n</span><span class="err">_s</span><span class="kc">te</span><span class="err">ps=</span><span class="mi">50</span>
</code></pre></div>
<p>一般来说如果是抓取固定的物体，n_obs_steps（3~5）设置可设较小值，chun_size设置大一点以减少策略调用频率，n_action_steps一般取chunk_size/2。如果是动态的环境（如装配、堆叠）n_obs_steps建议设置大一点10~20，chunk_size也缩减一点。</p>
<p><a href="https://www.laumy.tech/wp-content/uploads/2025/08/wp_editor_md_9b0578649e02feafd11bb25310ddc2ad.jpg"><img alt="" src="assets/doc/04-ai/lerobot/lerobot搭建/images/wp_editor_md_9b0578649e02feafd11bb25310ddc2ad.jpg"/></a></p>
<ul>
<li>action.xxx: 代表的是要设定执行的动作，也就是主臂或者模型推理处理发送的指令。</li>
<li>observation.xxx:实际执行的动作。</li>
</ul>
<p>一般情况下observation要跟action越吻合越好。</p>
<h2 id="_9">其他（废弃）</h2>
<p>用于记录，可不用看</p>
<h3 id="mac">mac</h3>
<p>找uart和摄像头</p>
<div class="codehilite"><pre><span></span><code><span class="n">export</span> <span class="n">HF_USER</span><span class="o">=</span><span class="n">laumy</span>
<span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">lerobot</span><span class="o">.</span><span class="n">find_port</span>
<span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">lerobot</span><span class="o">.</span><span class="n">find_cameras</span>
</code></pre></div>
<p>从臂标定</p>
<div class="codehilite"><pre><span></span><code><span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">lerobot</span><span class="o">.</span><span class="n">calibrate</span> \
    <span class="o">--</span><span class="n">robot</span><span class="o">.</span><span class="n">type</span><span class="o">=</span><span class="n">so101_follower</span> \
    <span class="o">--</span><span class="n">robot</span><span class="o">.</span><span class="n">port</span><span class="o">=/</span><span class="n">dev</span><span class="o">/</span><span class="n">tty</span><span class="o">.</span><span class="n">usbmodem5A7A0576331</span> \
    <span class="o">--</span><span class="n">robot</span><span class="o">.</span><span class="n">id</span><span class="o">=</span><span class="n">R12252801</span>
</code></pre></div>
<p>主臂标定</p>
<div class="codehilite"><pre><span></span><code><span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">lerobot</span><span class="o">.</span><span class="n">calibrate</span> \
    <span class="o">--</span><span class="n">teleop</span><span class="o">.</span><span class="n">type</span><span class="o">=</span><span class="n">so101_leader</span> \
    <span class="o">--</span><span class="n">teleop</span><span class="o">.</span><span class="n">port</span><span class="o">=/</span><span class="n">dev</span><span class="o">/</span><span class="n">tty</span><span class="o">.</span><span class="n">usbmodem5A7A0582001</span> \
    <span class="o">--</span><span class="n">teleop</span><span class="o">.</span><span class="n">id</span><span class="o">=</span><span class="n">R07252608</span>
</code></pre></div>
<p>示教</p>
<div class="codehilite"><pre><span></span><code><span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">lerobot</span><span class="o">.</span><span class="n">teleoperate</span> \
    <span class="o">--</span><span class="n">robot</span><span class="o">.</span><span class="n">type</span><span class="o">=</span><span class="n">so101_follower</span> \
    <span class="o">--</span><span class="n">robot</span><span class="o">.</span><span class="n">port</span><span class="o">=/</span><span class="n">dev</span><span class="o">/</span><span class="n">ttyACM0</span> \
    <span class="o">--</span><span class="n">robot</span><span class="o">.</span><span class="n">id</span><span class="o">=</span><span class="n">R12252801</span> \
    <span class="o">--</span><span class="n">teleop</span><span class="o">.</span><span class="n">type</span><span class="o">=</span><span class="n">so101_leader</span> \
    <span class="o">--</span><span class="n">teleop</span><span class="o">.</span><span class="n">port</span><span class="o">=/</span><span class="n">dev</span><span class="o">/</span><span class="n">ttyACM1</span> \
    <span class="o">--</span><span class="n">teleop</span><span class="o">.</span><span class="n">id</span><span class="o">=</span><span class="n">R07252608</span>
</code></pre></div>
<p>采集数据</p>
<div class="codehilite"><pre><span></span><code><span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">lerobot</span><span class="o">.</span><span class="n">record</span> \
    <span class="o">--</span><span class="n">robot</span><span class="o">.</span><span class="n">disable_torque_on_disconnect</span><span class="o">=</span><span class="n">true</span> \
    <span class="o">--</span><span class="n">robot</span><span class="o">.</span><span class="n">type</span><span class="o">=</span><span class="n">so101_follower</span> \
    <span class="o">--</span><span class="n">robot</span><span class="o">.</span><span class="n">port</span><span class="o">=/</span><span class="n">dev</span><span class="o">/</span><span class="n">ttyACM0</span> \
    <span class="o">--</span><span class="n">robot</span><span class="o">.</span><span class="n">id</span><span class="o">=</span><span class="n">R12252801</span> \
    <span class="o">--</span><span class="n">robot</span><span class="o">.</span><span class="n">cameras</span><span class="o">=</span><span class="s2">"{ handeye: {type: opencv, index_or_path: 8, width: 640, height: 360, fps: 30}, fixed: {type: opencv, index_or_path: 10, width: 640, height: 360, fps: 30}}"</span> \
    <span class="o">--</span><span class="n">teleop</span><span class="o">.</span><span class="n">type</span><span class="o">=</span><span class="n">so101_leader</span> \
    <span class="o">--</span><span class="n">teleop</span><span class="o">.</span><span class="n">port</span><span class="o">=/</span><span class="n">dev</span><span class="o">/</span><span class="n">ttyACM1</span> \
    <span class="o">--</span><span class="n">teleop</span><span class="o">.</span><span class="n">id</span><span class="o">=</span><span class="n">R07252608</span> \
    <span class="o">--</span><span class="n">dataset</span><span class="o">.</span><span class="n">repo_id</span><span class="o">=</span><span class="err">$</span><span class="p">{</span><span class="n">HF_USER</span><span class="p">}</span><span class="o">/</span><span class="n">record</span><span class="o">-</span><span class="n">test</span> \
    <span class="o">--</span><span class="n">dataset</span><span class="o">.</span><span class="n">num_episodes</span><span class="o">=</span><span class="mi">10</span> \
    <span class="o">--</span><span class="n">dataset</span><span class="o">.</span><span class="n">reset_time_s</span><span class="o">=</span><span class="mi">5</span> \
    <span class="o">--</span><span class="n">dataset</span><span class="o">.</span><span class="n">push_to_hub</span><span class="o">=</span><span class="n">false</span> \
    <span class="o">--</span><span class="n">dataset</span><span class="o">.</span><span class="n">single_task</span><span class="o">=</span><span class="s2">"Grab the cube"</span>
</code></pre></div>
<p>训练</p>
<div class="codehilite"><pre><span></span><code><span class="n">python</span> <span class="o">./</span><span class="n">src</span><span class="o">/</span><span class="n">lerobot</span><span class="o">/</span><span class="n">scripts</span><span class="o">/</span><span class="n">train</span><span class="o">.</span><span class="n">py</span> \
  <span class="o">--</span><span class="n">dataset</span><span class="o">.</span><span class="n">repo_id</span><span class="o">=</span><span class="err">$</span><span class="p">{</span><span class="n">HF_USER</span><span class="p">}</span><span class="o">/</span><span class="n">data_07181406</span> \
  <span class="o">--</span><span class="n">policy</span><span class="o">.</span><span class="n">type</span><span class="o">=</span><span class="n">act</span> \
  <span class="o">--</span><span class="n">output_dir</span><span class="o">=</span><span class="n">outputs</span><span class="o">/</span><span class="n">train</span><span class="o">/</span><span class="n">weigh_07181406</span> \
  <span class="o">--</span><span class="n">job_name</span><span class="o">=</span><span class="n">act_so101_test</span> \
  <span class="o">--</span><span class="n">policy</span><span class="o">.</span><span class="n">device</span><span class="o">=</span><span class="n">cuda</span> \
  <span class="o">--</span><span class="n">policy</span><span class="o">.</span><span class="n">push_to_hub</span><span class="o">=</span><span class="n">false</span> \
  <span class="o">--</span><span class="n">wandb</span><span class="o">.</span><span class="n">enable</span><span class="o">=</span><span class="n">false</span>
</code></pre></div>
<p>测试</p>
<div class="codehilite"><pre><span></span><code><span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">lerobot</span><span class="o">.</span><span class="n">record</span>  \
  <span class="o">--</span><span class="n">robot</span><span class="o">.</span><span class="n">type</span><span class="o">=</span><span class="n">so101_follower</span> \
  <span class="o">--</span><span class="n">robot</span><span class="o">.</span><span class="n">disable_torque_on_disconnect</span><span class="o">=</span><span class="n">true</span> \
  <span class="o">--</span><span class="n">robot</span><span class="o">.</span><span class="n">port</span><span class="o">=/</span><span class="n">dev</span><span class="o">/</span><span class="n">ttyACM0</span> \
<span class="o">--</span><span class="n">robot</span><span class="o">.</span><span class="n">cameras</span><span class="o">=</span><span class="s2">"{ handeye: {type: opencv, index_or_path: 8, width: 640, height: 360, fps: 30}, fixed: {type: opencv, index_or_path: 10, width: 640, height: 360, fps: 30}}"</span> \
  <span class="o">--</span><span class="n">robot</span><span class="o">.</span><span class="n">id</span><span class="o">=</span><span class="n">R12252801</span> \
  <span class="o">--</span><span class="n">display_data</span><span class="o">=</span><span class="n">false</span> \
  <span class="o">--</span><span class="n">dataset</span><span class="o">.</span><span class="n">single_task</span><span class="o">=</span><span class="s2">"Put lego brick into the transparent box"</span> \
  <span class="o">--</span><span class="n">policy</span><span class="o">.</span><span class="n">path</span><span class="o">=</span><span class="n">outputs</span><span class="o">/</span><span class="mi">100000</span><span class="o">/</span><span class="n">pretrained_model</span> \
  <span class="o">--</span><span class="n">dataset</span><span class="o">.</span><span class="n">repo_id</span><span class="o">=</span><span class="err">$</span><span class="p">{</span><span class="n">HF_USER</span><span class="p">}</span><span class="o">/</span><span class="n">eval_so101</span>
</code></pre></div>
<h3 id="windows">windows</h3>
<p>找uart和摄像头</p>
<div class="codehilite"><pre><span></span><code><span class="nb">set</span> <span class="n">HF_USER</span><span class="o">=</span><span class="mi">86152</span>
<span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">lerobot</span><span class="o">.</span><span class="n">find_port</span>
<span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">lerobot</span><span class="o">.</span><span class="n">find_cameras</span>
</code></pre></div>
<p>从臂标定</p>
<div class="codehilite"><pre><span></span><code><span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">lerobot</span><span class="o">.</span><span class="n">calibrate</span> <span class="err">`</span>
    <span class="o">--</span><span class="n">robot</span><span class="o">.</span><span class="n">type</span><span class="o">=</span><span class="n">so101_follower</span> <span class="err">`</span>
    <span class="o">--</span><span class="n">robot</span><span class="o">.</span><span class="n">port</span><span class="o">=</span><span class="n">COM5</span> <span class="err">`</span>
    <span class="o">--</span><span class="n">robot</span><span class="o">.</span><span class="n">id</span><span class="o">=</span><span class="n">R12252801</span>
</code></pre></div>
<p>主臂标定</p>
<div class="codehilite"><pre><span></span><code><span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">lerobot</span><span class="o">.</span><span class="n">calibrate</span> <span class="err">`</span>
    <span class="o">--</span><span class="n">teleop</span><span class="o">.</span><span class="n">type</span><span class="o">=</span><span class="n">so101_leader</span> <span class="err">`</span>
    <span class="o">--</span><span class="n">teleop</span><span class="o">.</span><span class="n">port</span><span class="o">=</span><span class="n">COM6</span> <span class="err">`</span>
    <span class="o">--</span><span class="n">teleop</span><span class="o">.</span><span class="n">id</span><span class="o">=</span><span class="n">R07252608</span>
</code></pre></div>
<p>示教</p>
<div class="codehilite"><pre><span></span><code><span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">lerobot</span><span class="o">.</span><span class="n">teleoperate</span> <span class="err">`</span>
    <span class="o">--</span><span class="n">robot</span><span class="o">.</span><span class="n">type</span><span class="o">=</span><span class="n">so101_follower</span> <span class="err">`</span>
    <span class="o">--</span><span class="n">robot</span><span class="o">.</span><span class="n">port</span><span class="o">=</span><span class="n">COM5</span> <span class="err">`</span>
    <span class="o">--</span><span class="n">robot</span><span class="o">.</span><span class="n">id</span><span class="o">=</span><span class="n">R12252801</span> <span class="err">`</span>
    <span class="o">--</span><span class="n">teleop</span><span class="o">.</span><span class="n">type</span><span class="o">=</span><span class="n">so101_leader</span> <span class="err">`</span>
    <span class="o">--</span><span class="n">teleop</span><span class="o">.</span><span class="n">port</span><span class="o">=</span><span class="n">COM6</span> <span class="err">`</span>
    <span class="o">--</span><span class="n">teleop</span><span class="o">.</span><span class="n">id</span><span class="o">=</span><span class="n">R07252608</span>
</code></pre></div>
<p>录制</p>
<div class="codehilite"><pre><span></span><code><span class="n">t</span>
</code></pre></div>
<p>训练</p>
<div class="codehilite"><pre><span></span><code><span class="n">python</span> <span class="n">src</span><span class="o">/</span><span class="n">lerobot</span><span class="o">/</span><span class="n">scripts</span><span class="o">/</span><span class="n">train</span><span class="o">.</span><span class="n">py</span> <span class="err">`</span>
  <span class="o">--</span><span class="n">dataset</span><span class="o">.</span><span class="n">repo_id</span><span class="o">=</span><span class="mi">86152</span><span class="o">/</span><span class="n">data_07181406</span> <span class="err">`</span>
  <span class="o">--</span><span class="n">policy</span><span class="o">.</span><span class="n">type</span><span class="o">=</span><span class="n">act</span> <span class="err">`</span>
  <span class="o">--</span><span class="n">output_dir</span><span class="o">=</span><span class="n">outputs</span><span class="o">/</span><span class="n">train</span><span class="o">/</span><span class="n">weigh_07181406</span> <span class="err">`</span>
  <span class="o">--</span><span class="n">job_name</span><span class="o">=</span><span class="n">act_so101_test</span> <span class="err">`</span>
  <span class="o">--</span><span class="n">policy</span><span class="o">.</span><span class="n">device</span><span class="o">=</span><span class="n">cuda</span> <span class="err">`</span>
  <span class="o">--</span><span class="n">policy</span><span class="o">.</span><span class="n">push_to_hub</span><span class="o">=</span><span class="n">false</span> <span class="err">`</span>
  <span class="o">--</span><span class="n">wandb</span><span class="o">.</span><span class="n">enable</span><span class="o">=</span><span class="n">false</span>
</code></pre></div>
<p>测试</p>
<div class="codehilite"><pre><span></span><code><span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">lerobot</span><span class="o">.</span><span class="n">record</span>  <span class="err">`</span>
  <span class="o">--</span><span class="n">robot</span><span class="o">.</span><span class="n">type</span><span class="o">=</span><span class="n">so101_follower</span> <span class="err">`</span>
  <span class="o">--</span><span class="n">robot</span><span class="o">.</span><span class="n">disable_torque_on_disconnect</span><span class="o">=</span><span class="n">true</span> <span class="err">`</span>
  <span class="o">--</span><span class="n">robot</span><span class="o">.</span><span class="n">port</span><span class="o">=</span><span class="n">COM5</span> <span class="err">`</span>
  <span class="o">--</span><span class="n">robot</span><span class="o">.</span><span class="n">cameras</span><span class="o">=</span><span class="s2">"{ handeye: {type: opencv, index_or_path: 1, width: 640, height: 360, fps: 30}, fixed: {type: opencv, index_or_path: 2, width: 640, height: 360, fps: 30}}"</span> <span class="err">`</span>
  <span class="o">--</span><span class="n">robot</span><span class="o">.</span><span class="n">id</span><span class="o">=</span><span class="n">R12252801</span> <span class="err">`</span>
  <span class="o">--</span><span class="n">display_data</span><span class="o">=</span><span class="n">false</span> <span class="err">`</span>
  <span class="o">--</span><span class="n">dataset</span><span class="o">.</span><span class="n">single_task</span><span class="o">=</span><span class="s2">"Put lego brick into the transparent box"</span> <span class="err">`</span>
  <span class="o">--</span><span class="n">dataset</span><span class="o">.</span><span class="n">repo_id</span><span class="o">=</span><span class="err">$</span><span class="p">{</span><span class="n">HF_USER</span><span class="p">}</span><span class="o">/</span><span class="n">eval_so101</span> <span class="err">`</span>
  <span class="o">--</span><span class="n">policy</span><span class="o">.</span><span class="n">path</span><span class="o">=</span><span class="n">outputs</span><span class="o">/</span><span class="n">train</span><span class="o">/</span><span class="n">weigh_07172300</span><span class="o">/</span><span class="n">checkpoints</span><span class="o">/</span><span class="n">last</span><span class="o">/</span><span class="n">pretrained_model</span>
</code></pre></div>
<h3 id="unbuntu">unbuntu</h3>
<div class="codehilite"><pre><span></span><code><span class="n">export</span> <span class="n">HF_USER</span><span class="o">=</span><span class="n">laumy</span>
</code></pre></div>
<div class="codehilite"><pre><span></span><code><span class="n">python</span> <span class="n">lerobot</span><span class="o">/</span><span class="n">scripts</span><span class="o">/</span><span class="n">find_motors_bus_port</span><span class="o">.</span><span class="n">py</span>
</code></pre></div>
<div class="codehilite"><pre><span></span><code><span class="n">python</span> <span class="n">lerobot</span><span class="o">/</span><span class="n">common</span><span class="o">/</span><span class="n">robot_devices</span><span class="o">/</span><span class="n">cameras</span><span class="o">/</span><span class="n">opencv</span><span class="o">.</span><span class="n">py</span>
</code></pre></div>
<div class="codehilite"><pre><span></span><code><span class="n">python</span> <span class="n">lerobot</span><span class="o">/</span><span class="n">scripts</span><span class="o">/</span><span class="n">control_robot</span><span class="o">.</span><span class="n">py</span> \
  <span class="o">--</span><span class="n">robot</span><span class="o">.</span><span class="n">type</span><span class="o">=</span><span class="n">so101</span> \
  <span class="o">--</span><span class="n">control</span><span class="o">.</span><span class="n">type</span><span class="o">=</span><span class="n">record</span> \
  <span class="o">--</span><span class="n">control</span><span class="o">.</span><span class="n">fps</span><span class="o">=</span><span class="mi">30</span> \
  <span class="o">--</span><span class="n">control</span><span class="o">.</span><span class="n">single_task</span><span class="o">=</span><span class="s2">"Grasp a lego block and put it in the bin."</span> \
  <span class="o">--</span><span class="n">control</span><span class="o">.</span><span class="n">repo_id</span><span class="o">=</span><span class="err">$</span><span class="p">{</span><span class="n">HF_USER</span><span class="p">}</span><span class="o">/</span><span class="n">so101_test</span> \
  <span class="o">--</span><span class="n">control</span><span class="o">.</span><span class="n">tags</span><span class="o">=</span><span class="s1">'["so101","tutorial"]'</span> \
  <span class="o">--</span><span class="n">control</span><span class="o">.</span><span class="n">warmup_time_s</span><span class="o">=</span><span class="mi">5</span> \
  <span class="o">--</span><span class="n">control</span><span class="o">.</span><span class="n">episode_time_s</span><span class="o">=</span><span class="mi">30</span> \
  <span class="o">--</span><span class="n">control</span><span class="o">.</span><span class="n">reset_time_s</span><span class="o">=</span><span class="mi">5</span> \
  <span class="o">--</span><span class="n">control</span><span class="o">.</span><span class="n">num_episodes</span><span class="o">=</span><span class="mi">10</span> \
  <span class="o">--</span><span class="n">control</span><span class="o">.</span><span class="n">push_to_hub</span><span class="o">=</span><span class="n">false</span>
</code></pre></div>
<p>如果要继续上一次的录制，可以添加在上面命令基础上加上：--control.resume=true</p>
<p>可视化训练数据</p>
<div class="codehilite"><pre><span></span><code><span class="n">python</span> <span class="n">lerobot</span><span class="o">/</span><span class="n">scripts</span><span class="o">/</span><span class="n">visualize_dataset_html</span><span class="o">.</span><span class="n">py</span> <span class="o">--</span><span class="n">repo</span><span class="o">-</span><span class="nb">id</span> <span class="err">$</span><span class="p">{</span><span class="n">HF_USER</span><span class="p">}</span><span class="o">/</span><span class="n">so101_test</span>
</code></pre></div>
<p>拷贝数据到服务器</p>
<div class="codehilite"><pre><span></span><code><span class="n">scp</span> <span class="o">-</span><span class="n">P</span> <span class="mi">18620</span> <span class="n">so101_test</span><span class="o">.</span><span class="n">tar</span><span class="o">.</span><span class="n">gz</span> <span class="n">root</span><span class="nd">@connect</span><span class="o">.</span><span class="n">bjb1</span><span class="o">.</span><span class="n">seetacloud</span><span class="o">.</span><span class="n">com</span><span class="p">:</span><span class="o">~/</span>
</code></pre></div>
<div class="codehilite"><pre><span></span><code><span class="n">python</span> <span class="n">lerobot</span><span class="o">/</span><span class="n">scripts</span><span class="o">/</span><span class="n">train</span><span class="o">.</span><span class="n">py</span> \
  <span class="o">--</span><span class="n">dataset</span><span class="o">.</span><span class="n">repo_id</span><span class="o">=</span><span class="err">$</span><span class="p">{</span><span class="n">HF_USER</span><span class="p">}</span><span class="o">/</span><span class="n">so101_test</span> \
  <span class="o">--</span><span class="n">policy</span><span class="o">.</span><span class="n">type</span><span class="o">=</span><span class="n">act</span> \
  <span class="o">--</span><span class="n">output_dir</span><span class="o">=</span><span class="n">outputs</span><span class="o">/</span><span class="n">train</span><span class="o">/</span><span class="n">act_so101_test0717</span> \
  <span class="o">--</span><span class="n">job_name</span><span class="o">=</span><span class="n">act_so101_test</span> \
  <span class="o">--</span><span class="n">policy</span><span class="o">.</span><span class="n">device</span><span class="o">=</span><span class="n">cuda</span> \
  <span class="o">--</span><span class="n">wandb</span><span class="o">.</span><span class="n">enable</span><span class="o">=</span><span class="n">false</span>
</code></pre></div>
<div class="codehilite"><pre><span></span><code><span class="n">python</span> <span class="n">lerobot</span><span class="o">/</span><span class="n">scripts</span><span class="o">/</span><span class="n">control_robot</span><span class="o">.</span><span class="n">py</span> \
  <span class="o">--</span><span class="n">robot</span><span class="o">.</span><span class="n">type</span><span class="o">=</span><span class="n">so101</span> \
  <span class="o">--</span><span class="n">control</span><span class="o">.</span><span class="n">type</span><span class="o">=</span><span class="n">record</span> \
  <span class="o">--</span><span class="n">control</span><span class="o">.</span><span class="n">fps</span><span class="o">=</span><span class="mi">30</span> \
  <span class="o">--</span><span class="n">control</span><span class="o">.</span><span class="n">single_task</span><span class="o">=</span><span class="s2">"Grasp a lego block and put it in the bin."</span> \
  <span class="o">--</span><span class="n">control</span><span class="o">.</span><span class="n">repo_id</span><span class="o">=</span><span class="err">$</span><span class="p">{</span><span class="n">HF_USER</span><span class="p">}</span><span class="o">/</span><span class="n">eval_act_so101_test</span> \
  <span class="o">--</span><span class="n">control</span><span class="o">.</span><span class="n">tags</span><span class="o">=</span><span class="s1">'["tutorial"]'</span> \
  <span class="o">--</span><span class="n">control</span><span class="o">.</span><span class="n">warmup_time_s</span><span class="o">=</span><span class="mi">5</span> \
  <span class="o">--</span><span class="n">control</span><span class="o">.</span><span class="n">episode_time_s</span><span class="o">=</span><span class="mi">30</span> \
  <span class="o">--</span><span class="n">control</span><span class="o">.</span><span class="n">reset_time_s</span><span class="o">=</span><span class="mi">30</span> \
  <span class="o">--</span><span class="n">control</span><span class="o">.</span><span class="n">num_episodes</span><span class="o">=</span><span class="mi">10</span> \
  <span class="o">--</span><span class="n">control</span><span class="o">.</span><span class="n">push_to_hub</span><span class="o">=</span><span class="n">false</span> \
  <span class="o">--</span><span class="n">control</span><span class="o">.</span><span class="n">policy</span><span class="o">.</span><span class="n">path</span><span class="o">=</span><span class="n">outputs</span><span class="o">/</span><span class="n">train</span><span class="o">/</span><span class="n">act_so101_test</span><span class="o">/</span><span class="n">checkpoints</span><span class="o">/</span><span class="n">last</span><span class="o">/</span><span class="n">pretrained_model</span>
</code></pre></div></div>
  <div class="post-nav">
    <a class="prev" href="安装unbuntu双系统.html">← 安装unbuntu双系统</a>
    <a class="next" href="pip-install.html">pip install →</a>
  </div>
</article>

      </section>

      <aside class="right-panel">
        
      </aside>
    </main>

    <footer class="site-footer">
      <div class="container">Copyright ©2022-2025 laumy 版权所有</div>
    </footer>

    <script src="assets/site.js"></script>
  </body>
  </html>

